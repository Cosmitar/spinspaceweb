{"version":3,"sources":["assets/emotes/emote_swirl.png","assets/emotes/emote_alert.png","assets/textures/cube_rock_A_mat_baseColor.png","src/systems/World/EventsManager.ts","assets/textures/cube_rock_A_mat_normal.png","assets/fonts/Sandoval.ttf","assets/ui/Light rock formation texture.jpg","assets/ui/star_base_stone.png","assets/ui/star_base_graphite.png","assets/ui/star_filled_stone.png","assets/ui/star_filled_graphite.png","src/systems/Physics/context.js","src/systems/Physics/hooks.js","src/systems/World/hooks.js","src/components/UfoModels/UfoModel1.js","src/components/UfoModels/UfoModel2.js","src/components/UfoModels/UfoModel3.js","src/components/UfoModels/UfoModel4.js","src/helpers/anime.js","src/constants/gameOptions.js","src/components/UfoShip/index.js","src/hooks/useOutOfTheBox.js","src/components/Arena2/arenaHelper.js","src/helpers/animateFallUp.js","src/helpers/respawnMe.js","src/hooks/useCollision.tsx","src/components/Enemy/index.js","src/components/Player/index.js","src/systems/World/CharactersLoop.js","src/systems/World/HitPhysics.js","src/systems/Physics/Provider.js","src/systems/Physics/index.js","src/hooks/useKeyPress.js","src/systems/HUD/Controllers.js","src/components/RockCube/index.js","src/components/Crystal/index.js","src/components/Wall/index.js","src/constants/levels.js","src/components/CountDown/index.js","src/scenes/GameScene/index.js","src/components/RevertSpinArea/index.js","src/components/UfoBase/index.js","src/components/Portals/index.js","src/systems/HUD/index.js","src/constants/webView_comm_messages.js","src/components/Sparks/index.js","src/scenes/TitleScene/UfoPlayer.js","src/scenes/TitleScene/CameraAnimation.js","src/scenes/TitleScene/index.js","src/screenComponents/Stars/star.js","src/screenComponents/Stars/index.js","src/scenes/DebugScene/index.js","src/components/Trophy/index.js","src/components/BasicObj/index.js","src/components/Rocks/index.js","src/components/CrystalRock/index.js","src/scenes/TheEndScene/index.js","src/scenes/index.js","App.tsx","index.js","assets/threeTone.jpg","src/systems/World/index.js","src/systems/World/Events.js","src/helpers/eventsService.js"],"names":["module","exports","EventsManager","EventsService","CollisionsManager","this","service","callback","onBeginContact","filterUUID","contact","fixtureA","GetFixtureA","fixtureB","GetFixtureB","isRelevantCollistion","GetBody","GetUserData","uuid","includes","collideAgainstFixture","addEventListener","CHARACTER_EVENTS","BEGIN_CONTACT","END_CONTACT","dispatch","context","createContext","b2FixtureDef","Box2D","Dynamics","b2BodyDef","b2Body","b2Vec2","Common","Math","shapes","circle","Collision","Shapes","b2CircleShape","box","b2PolygonShape","useApi","useContext","refs","world","destroyQueue","impulse","state","hasOwnProperty","body","freeze","SetUserData","rotate","object","userData","unfreeze","destroy","push","restart","originPosition","origin","console","log","x","y","SetLinearVelocity","SetTransform","position","GetAngle","f","GetFixtureList","GetNext","SetSensor","createCharacter","type","fixtureDef","shape","bodyDef","static","b2_staticBody","b2_dynamicBody","SetRadius","radius","SetAsBox","hx","hy","density","friction","restitution","isSensor","pickable","linearDamping","bullet","Set","z","angle","CreateBody","CreateFixture","spinFactor","grow","m_shape","m_radius","hulk","revertSpin","overchargePower","coil","dischargePower","overchargeFreezer","freezer","dischargeFreeze","hyperJump","outOfThisWorld","getPhysicsUserData","useBody","config","fwdRef","localRef","useRef","ref","api","useEffect","current","useCircle","useBox","useEvents","evntName","eventsManager","unsubscribeEvent","eventPayload","loaderObj","OBJLoader","loaderMtl","MTLLoader","textureLoader","THREE","TextureLoader","forwardRef","props","useState","geometry","setGeometry","colorPalette","moreProps","threeTone","load","require","minFilter","NearestFilter","magFilter","MeshBasicMaterial","color","materialChassis","MeshToonMaterial","gradientMap","MeshLambertMaterial","materialDeco","materialCore","materialDome","a","async","mtl","parse","preload","setMaterials","obj","children","material","castShadow","useMemo","SVGElement","HTMLInputElement","defaultInstanceSettings","update","begin","loopBegin","changeBegin","change","changeComplete","loopComplete","complete","loop","direction","autoplay","timelineOffset","defaultTweenSettings","duration","delay","endDelay","easing","round","cache","CSS","springs","minMax","val","min","max","stringContains","str","text","indexOf","applyArguments","func","args","apply","is","arr","Array","isArray","Object","prototype","toString","call","pth","svg","inp","dom","nodeType","fnc","und","hex","test","rgb","hsl","col","key","parseEasingParameters","string","match","exec","split","map","p","parseFloat","spring","params","mass","stiffness","damping","velocity","w0","sqrt","zeta","wd","b","solver","t","progress","exp","cos","sin","cached","elapsed","rest","steps","ceil","bezier","A","aA1","aA2","B","C","calcBezier","aT","getSlope","mX1","mY1","mX2","mY2","sampleValues","Float32Array","i","getTForX","aX","intervalStart","currentSample","kSplineTableSize","guessForT","initialSlope","aGuessT","currentSlope","newtonRaphsonIterate","aA","aB","currentX","currentT","abs","binarySubdivide","penner","eases","linear","functionEasings","Sine","PI","Circ","Back","Bounce","pow2","pow","Elastic","amplitude","period","asin","forEach","name","keys","easeIn","parseEasings","ease","filterArray","len","length","thisArg","arguments","result","flattenArray","reduce","concat","toArray","o","arrayContains","some","cloneObject","clone","replaceObjectProps","o1","o2","mergeObjects","colorToRgb","rgbValue","rgbToRgba","hexValue","replace","m","r","g","parseInt","hexToRgba","hslValue","h","s","l","hue2rgb","q","hslToRgba","getUnit","getFunctionValue","animatable","target","id","total","getAttribute","el","prop","convertPxToUnit","value","unit","appendChild","style","width","factor","offsetWidth","removeChild","convertedUnit","getElementTransforms","transform","reg","transforms","Map","set","getOriginalTargetValue","propName","getRelativeValue","to","from","operator","u","validateValue","originalUnit","unitLess","substr","getDistance","p1","p2","getPolylineLength","previousPos","points","totalLength","numberOfItems","currentPos","getItem","getTotalLength","tagName","toLowerCase","getCircleLength","getRectLength","getLineLength","getPolygonLength","getParentSvg","pathEl","svgData","parentSvgEl","parentEl","parentNode","getParentSvgEl","rect","getBoundingClientRect","viewBoxAttr","height","viewBox","w","getPathProgress","path","point","offset","getPointAtLength","p0","property","atan2","decomposeValue","rgx","original","numbers","Number","strings","parseTargets","targets","item","pos","self","getAnimatables","parsed","list","normalizePropertyTweens","tweenSettings","settings","propArray","v","k","getProperties","properties","keyframes","propertyNames","newKey","flattenKeyframes","tweens","normalizeTweens","previousTween","tween","normalizeTweenValues","tweenValue","toUnit","originalValue","previousValue","fromUnit","start","end","isPath","isColor","setProgressValue","css","attribute","setAttribute","manual","last","setTargetsValue","valueUnit","getAnimations","animatables","animType","lastTween","createAnimation","getInstanceTimings","animations","animLength","getTlOffset","anim","timings","instanceID","createNewInstance","instanceSettings","raf","activeInstances","engine","play","requestAnimationFrame","step","activeInstancesLength","activeInstance","paused","instanceIndex","splice","tick","cancelAnimationFrame","anime","startTime","lastTime","now","childrenLength","resolve","makePromise","instance","promise","Promise","_resolve","finished","toggleInstanceDirection","reversed","child","adjustTime","time","resetTime","currentTime","speed","seekChild","seek","syncInstanceChildren","reversePlayback","setAnimationsProgress","insTime","animationsLength","tweenLength","eased","isNaN","toNumbersLength","n","toNumber","fromNumber","stringsLength","currentValue","setCallback","cb","passThrough","countIteration","remaining","setInstanceProgress","engineTime","insDuration","insDelay","insEndDelay","began","loopBegan","changeBegan","changeCompleted","completed","reset","pause","reverse","removeTargetsFromAnimations","targetsArray","version","running","remove","c","childAnimations","get","convertPx","percent","e","selectString","setDashoffset","pathLength","stagger","grid","axis","fromIndex","fromFirst","fromCenter","fromLast","isRange","val1","val2","values","maxValue","index","fromX","fromY","floor","distanceX","distanceY","timeline","tl","add","instanceParams","tlIndex","ins","insParams","tlDuration","random","PALETTES","1","2","3","4","SmokeInstances","originMeshRef","seed","sphereRefs","range","center","initialPositions","useFrame","idx","INCREMENT","opacity","transparent","Model","isFreezed","setFreezed","emote","setEmote","MeshNormalMaterial","wireframe","side","BackSide","powerMaterial","emoteTimerId","powerRef","ufoRef","baseRef","GETS_FREEZER","PICK_CRYSTAL_GROW","targetObj","scale","growOverchargeSphere","visible","PICK_CRYSTAL_COIL","PICK_CRYSTAL_FREEZER","DISCHARGE","detached","EXTERNAL_SPIN_CHANGE","emoteSwirl","clearTimeout","setTimeout","UfoModel","indicatorGeometry","Geometry","v1","Vector3","v2","v3","vertices","faces","Face3","computeFaceNormals","materials","Color","indicatorColor","indicatorOffset","model","Ufo","Ufo2","Ufo3","Ufo4","indicatorMaterial","fallback","dispose","backgroundColor","marginTop","marginLeft","src","rotation","degToRad","useOutOfTheBox","elementRef","isOut","setIsOut","outFromLeft","outFromRight","outFromTop","outFromBottom","isOutOfArena","animateFallUp","onComplete","transformation","positionY","respawnMe","useCollision","subscribe","onCollide","bind","useLayoutEffect","unsubscribe","Enemy","externalRef","userController","enemies","spin","impulseRef","impulseTID","retargetTID","outOfRing","triggerOutOfRing","OUT_OF_RING","triggerImpulseOn","IMPULSE_ON","triggerImpulseOff","IMPULSE_OFF","GAME_EVENTS","READY_ON","setTarget","lookObject","Object3D","stopImpulse","forceTo","aggressiveness","getAggressivenessByModel","wanderness","getWandernessByModel","copy","getReflexesByModel","myself","impulseDuration","lookAt","rotateY","quaternion","angleTo","flagSafeTurn","turns","setTurns","originalAngle","setOriginalAngle","active","setActive","READY_OFF","useTurnsCounter","spinSpeed","UfoShip","isEnemy","Player","unsubscribeControllerOn","unsubscribeControllerOff","unsubscribeControllerRestart","unsubscribeControllerDoubleTap","isPlayer","b2RayCastOutput","fixtureIsCharacter","fix","isDirectHit","fixA","fixB","rayCastOutput","bodyA","GetPosition","bodyAPosX","bodyAPosY","dest","Add","rayInput","maxFraction","RayCast","isOvercharged","applyExtraImpulse","bodyB","extraPower","impulseVector","ApplyImpulse","GetWorldCenter","applyOverchargeCoil","posA","posB","Copy","Subtract","Normalize","HitPhysics","b2Contact","isDirectHitAtoB","isDirectHitBtoA","directHitAtoB","directHitBtoA","bodyAData","bodyBData","Date","hitBy","hitByTime","hitByDirect","setHitBy","GETS_COIL","overchargeReaction","b2World","b2ContactListener","Provider","onReady","setWorld","Clock","clock","IsLocked","newPos","CharactersLoop","getDelta","Step","DestroyBody","pop","gravity","contactListener","BeginContact","dispatchOnBeginContact","EndContact","dispatchOnEndContact","SetContactListener","SetContinuousPhysics","onEndContact","bodies","actions","Physics","useKeyPress","targetKey","keyPressed","setKeyPressed","downHandler","upHandler","window","removeEventListener","Dimensions","KEY_THROTTLE_BY_PLAYER_INDEX","0","SCREEN_POS_BY_PLAYER_INDEX","posX","posY","COLORS_BY_PLAYER_INDEX","player","controller","Controllers","forPlayers","noUI","players","playersConfig","keyboardThrottle","isThrottling","hit","usePlayers","SS_controller_p2_throttle","handleTouchStart","nativeEvent","touches","hitAreaPlayers","checkTouchOnPlayerAreas","evt","ha","pageX","pageY","touchTime","performance","diff","lastTouchTime","doubleTap","handleTouchEnd","useHitArea","P1ThrottleKeyPressed","P2ThrottleKeyPressed","Fragment","View","onTouchStart","onTouchEnd","bottom","right","left","loaderTxt","normalMapImage","texture","tint","mapImage","rockMaterial","FrontSide","normalMap","receiveShadow","font","fontSize","anchorX","anchorY","toUpperCase","COLORS_BY_TYPE","hide","show","timeToAppear","passProps","setStep","circleRef","triggerOnPickCoil","triggerOnPickFreezer","triggerOnPickGrow","triggerOnOvercharge","OVERCHARGE","collidedFixture","colorMaterial","animationLoop","RingGeometry","LineBasicMaterial","isWall","levels","arena","walls","crystals","crystalMinTimeToAppear","spinReverseAreas","portalGroups","playerRef","CountDown","count","setCount","setStart","gameReadyTrigger","systemOnlineTrigger","SYSTEM_ONLINE","camera","useThree","tId","undefined","destination","useAspect","scaleFactor","className","fontFamily","fontWeight","display","flex","boxSizing","flexDirection","alignItems","justifyContent","spinRevertTrigger","Portals","positionBlue","positionRed","portalBlue","portalRed","teleporting","onTeleportTrigger","TELEPORT","filter","UfoBase","fill","player1","player2","playersOnArena","GameScene","onLoad","currentLevel","levelId","CURRENT_LEVEL","LEVELS","enemyRefs","wallRefs","characterRef","isUserFall","playersAlive","pRef","thereArePlayersLeft","onlyOnePlayersLeft","userIsAlive","find","ReactNativeWebView","postMessage","ENEMY_DOWN","GAME_OVER","enemy","wall","Wall","crystal","Crystal","portals","area","RevertSpinArea","useLevels","dataA","dataB","data","World","background","shadowMap","fov","concurrent","gl","antialias","onCreated","intensity","distance","shadow-mapSize-width","shadow-mapSize-height","shadow-camera-far","shadow-camera-left","shadow-camera-right","shadow-camera-top","shadow-camera-bottom","extend","meshline","Fatline","curve","uniforms","dashOffset","attach","depthTest","lineWidth","dashArray","dashRatio","Sparks","mouse","colors","lines","_","CatmullRomCurve3","getPoints","size","viewport","aspect","lerp","setSpin","CameraAnimation","textureMap","TittlesFloor","ufo2Ref","ufo3Ref","ufo4Ref","cameraRef","scene","helper","CameraHelper","fog","Fog","colorStop","UfoPlayer","base_skin_stone","base_skin_graphite","skin_foreground_stone","skin_foreground_graphite","RectangularButton","empty","variant","skin","styles","button","Image","source","image","StyleSheet","create","maxWidth","maxHeight","baseImage","zIndex","resizeMode","Stars","smallStar","leftStar","rightStar","selection","visibleEdgeColor","edgeStrength","pulseSpeed","blur","modelObj","modelMtl","BasicObj","pivot","rotationSpeed","elevationFactor","frozenUfoRef","freezeEventTrigger","cameraPivot","Trophy","UfoModel1","UfoModel4","UfoModel3","UfoModel2","Rocks","CrystalRock","sunPosition","turbidity","rayleigh","mieCoefficient","mieDirectionalG","inclination","azimuth","scenes","SS_initial_scene","sceneName","setScene","sceneParams","SceneToRender","TitleScene","DebugScene","TheEndScene","sceneSelector","notifyOnLoad","SS_change_scene","container","registerRootComponent","document","script","createElement","gtag","dataLayer","head","lazy","WorldEvents","PICK_CRYSTAL_HULK","callbacks","eventName"],"mappings":"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","file":"static/js/app.29bc7e90.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAmCAMAAACS/WnbAAAABGdBTUEAALGPC/xhBQAAAGlQTFRF////////6urq5eXl4uLi8PDw9fX1////+vr6/v7+/v7+////AAAAi4iI9fX1ZGFh8PDwy8rKcW5usbCw8vHxfnt7pKOj6+vrmJaWV1RU5eTkSkdH5ubm2NfXPTo6vr294uLiMS0t////KmhJ/QAAAA10Uk5TX++fn5+fn4+f379/AN3SnhMAAAD5SURBVDjLzZNrF4IgDIbpXrYuCJpoQOz//8g26pgnkL72fvDo9rC9TBAgqgpnVFUCxBGLOopFGVgI/KG/A3zjgmn1HGBNiHKnPNCFUUZnAE+JgcqrC73UKdA7CmvsLWJLRJsADa1HS1RQ3MwlwBCC1y46UFjz4wugBKqXxYH91DmAmxsqZenrkmkhe/ZPBmTEU5NG+67j3dgcwKuNl9LwDmymxWSQnsu16aibd15xAWqT/qz+RE4HGYfalM5DNy2QAzzb+K9DeyjnD78vL+xK+R0IGLV+jFp/ohMAVve3VpAHYHmLWsIcAJsraQPzAGzP5y2UANjvvwJPs7+MIdFXRVwAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAmCAMAAACS/WnbAAAABGdBTUEAALGPC/xhBQAAAGlQTFRF////////6urq9fX18PDw5eXl4uLi/v7++vr6/////v7+////AAAA/6Uf9fX1/9KP/9+v/+W//6wv//Lf8PDw//jv/9if/7hP/79f/8x//8Vv6+vr/58P/+vP5ubm/7I/4uLi/5kA////l2ksqwAAAA10Uk5T71+fn5+fn9+fj79/AMmsCJoAAADsSURBVDjLzZPJFoIwDEWrqCBEmcRWpNbm/z9SOkgrR8LCjW/TnOTCS0JhsMlzXFCeb4AVSKpgjAbW6iPxf0CvlOgI4KpH9QQwGEATgP4ZCBayriOg5UrZ1pSpN4hdM548ADYvzJQmUH4afZ0AZ10iVua8IZ60Dz4AXbsmJEo9ewN3iaFDYR2E9r1MTSpH9NgOg3wPI+Mxe0e4zyBDB2EPZXB1sZgvytq4p25RPd5kxbn0QFORF6ar/+3SpnQ9Xf954UjVj8Bg0uE56RCyEQD7h9cevgOwvVttYQmA3WXUDpYBSM7nBCgAsmyWeAFkl4z4yo/4HQAAAABJRU5ErkJggg==\"","module.exports = __webpack_public_path__ + \"static/media/cube_rock_A_mat_baseColor.280c99eb.png\";","import Box2D from 'box2dweb'\nimport EventsService from '../../helpers/eventsService'\nimport { CHARACTER_EVENTS } from './Events';\n\ninterface b2ContactManager {\n  GetFixtureA:() => any,\n  GetFixtureB: () => any,\n}\n\nexport const EventsManager = new EventsService()\n\nclass Collisions {\n  service: any\n  constructor() {\n    this.service = EventsManager\n  }\n  \n  onAnyCollide(callback: Function) {\n    this.onBeginContact(callback)\n  }\n  onCollide(callback: Function, filterUUID: string): Function {\n    const filterCallback = (contact: b2ContactManager)  => {\n      const fixtureA = contact.GetFixtureA()\n      const fixtureB = contact.GetFixtureB()\n      const uuidA = fixtureA.GetBody().GetUserData().uuid\n      const uuidB = fixtureB.GetBody().GetUserData().uuid\n      const isRelevantCollistion = [uuidA, uuidB].includes(filterUUID)\n      const collideAgainstFixture = fixtureA.GetBody().GetUserData().uuid === filterUUID ? fixtureB : fixtureA\n      if (isRelevantCollistion) {\n        callback(collideAgainstFixture, contact)\n      }\n    }\n    return this.onBeginContact(filterCallback)\n  }\n\n  onBeginContact(callback: Function): Function {\n    return this.service.addEventListener(CHARACTER_EVENTS.BEGIN_CONTACT, callback)\n  }\n\n  onEndContact(callback: Function): Function {\n    return this.service.addEventListener(CHARACTER_EVENTS.END_CONTACT, callback)\n  }\n\n  dispatchOnBeginContact(contact: b2ContactManager) {\n    this.service.dispatch(CHARACTER_EVENTS.BEGIN_CONTACT, contact)\n  }\n\n  dispatchOnEndContact(contact: b2ContactManager) {\n    this.service.dispatch(CHARACTER_EVENTS.END_CONTACT, contact)\n  }\n}\n\n// class EventsManager {\n//   service: any\n//   constructor() {\n//     this.service = new EventsService()\n//   }\n// }\n\nexport const CollisionsManager = new Collisions()\n","module.exports = __webpack_public_path__ + \"static/media/cube_rock_A_mat_normal.5edfd7c9.png\";","module.exports = __webpack_public_path__ + \"./fonts/Sandoval.ttf\";","module.exports = __webpack_public_path__ + \"static/media/Light rock formation texture.555d136e.jpg\";","module.exports = __webpack_public_path__ + \"static/media/star_base_stone.37ef8b61.png\";","module.exports = __webpack_public_path__ + \"static/media/star_base_graphite.2629d975.png\";","module.exports = __webpack_public_path__ + \"static/media/star_filled_stone.a5242ba2.png\";","module.exports = __webpack_public_path__ + \"static/media/star_filled_graphite.004d4fdc.png\";","import React, { createContext } from 'react'\nconst context = createContext({})\n\nexport default context","import React, { useLayoutEffect, useContext, useRef, useMemo, useEffect, useState } from 'react'\nimport { THREE } from 'expo-three'\nimport { useFrame } from 'react-three-fiber'\nimport Box2D from 'box2dweb'\nimport context from './context'\n\nconst b2FixtureDef = Box2D.Dynamics.b2FixtureDef;\nconst b2BodyDef = Box2D.Dynamics.b2BodyDef;\nconst b2Body = Box2D.Dynamics.b2Body;\nconst b2Vec2 = Box2D.Common.Math.b2Vec2;\n\nconst shapes = {\n  circle: Box2D.Collision.Shapes.b2CircleShape,\n  box: Box2D.Collision.Shapes.b2PolygonShape,\n}\n\nexport function useApi () {\n  const { world, refs, destroyQueue } = useContext(context)\n  function impulse(uuid, state) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const body = refs[uuid].body\n    const { freeze } = body.GetUserData()\n    if (!freeze) {\n      body.SetUserData({ ...body.GetUserData(), impulse: state, rotate: !state })\n    }\n  }\n  function rotate(uuid, state) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const body = refs[uuid].body\n    const { freeze } = body.GetUserData()\n    if (!freeze) {\n      body.SetUserData({ ...body.GetUserData(), rotate: state })\n    }\n  }\n  function revertSpin(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const body = refs[uuid].body\n    const userData = body.GetUserData()\n    body.SetUserData({\n      ...userData,\n      spinFactor: userData.spinFactor * -1,\n    })\n  }\n  function overchargePower(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    body.SetUserData({ ...body.GetUserData(), coil: true })\n  }\n  function dischargePower(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    body.SetUserData({ ...body.GetUserData(), coil: false })\n  }\n  function overchargeFreezer(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    body.SetUserData({ ...body.GetUserData(), freezer: true })\n  }\n  function dischargeFreeze(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    body.SetUserData({ ...body.GetUserData(), freezer: false })\n  }\n  function grow(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body, object} = refs[uuid]\n    // const fixture = body.GetFixtureList()\n\n    // grow Box2D radius\n    body.GetFixtureList().m_shape.m_radius = body.GetFixtureList().m_shape.m_radius * 1.7\n    body.SetUserData({ ...body.GetUserData(), hulk: 1 })\n    // // grow ThreeJS scale\n    // object.scale.set(1.5, 1.5, 1.5)\n  }\n  function freeze(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const body = refs[uuid].body\n    body.SetUserData({ ...body.GetUserData(), rotate: false, freeze: true, impulse: false })\n    object.userData.freeze = true\n  }\n  function unfreeze(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body, object} = refs[uuid]\n    body.SetUserData({ ...body.GetUserData(), freeze: false })\n    object.userData.freeze = false\n  }\n  function hyperJump(uuid, { x = 0, y = 0 }) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    body.SetTransform({ position: {x, y}, GetAngle: () => body.GetAngle() })\n  }\n  function outOfThisWorld (uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    for (var f = body.GetFixtureList(); f; f = f.GetNext()) {\n      // disable collision\n      f.SetSensor(true)\n    }\n  }\n  function destroy (uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    destroyQueue.push(refs[uuid].body)\n  }\n  function restart (uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {object} = refs[uuid]\n    const originPosition = object.userData.origin\n    console.log(originPosition)\n    const [x, y, z] = originPosition || [0,0,0];\n    const origin = { x, y: z };\n    const body = refs[uuid].body\n    // remove forces\n    body.SetLinearVelocity(new b2Vec2(0, 0))\n    // restart angle and position\n    body.SetTransform({ position: { ...origin }, GetAngle: () => body.GetAngle() })\n    for (var f = body.GetFixtureList(); f; f = f.GetNext()) {\n      // re-enable collision\n      f.SetSensor(false)\n    }\n  }\n  const createCharacter = (object, type, world) => {\n    const fixtureDef = new b2FixtureDef()\n    fixtureDef.shape = new shapes[type]()\n    const bodyDef = new b2BodyDef();\n    bodyDef.type = object.userData.static ? b2Body.b2_staticBody : b2Body.b2_dynamicBody;\n    // fixtureDef.density = 1\n    if (type === 'circle') {\n      // if (!object.userData.radius) {\n      //   object.children[1].geometry.computeBoundingBox()\n      //   console.log(object.children[1].geometry.boundingBox, object.userData.radius)\n      // }\n      fixtureDef.shape.SetRadius(object.userData.radius || 0.5)\n    }\n    if (type === 'box') {\n      fixtureDef.shape.SetAsBox(object.userData.hx || 0.5, object.userData.hy || 0.5)\n    }\n\n    if (!object.userData.static) {\n      fixtureDef.density = object.userData.density || 1.0;\n      fixtureDef.friction = object.userData.friction  || 1;\n      fixtureDef.restitution = object.userData.restitution || 1;\n      fixtureDef.isSensor = object.userData.pickable || false;\n\n      bodyDef.linearDamping = 1\n      bodyDef.bullet = true\n    }\n    \n\n    bodyDef.position.Set(object.position.x, object.position.z)\n    bodyDef.angle = object.userData.angle || 0\n\n    const body = world.CreateBody(bodyDef)\n    body.CreateFixture(fixtureDef);\n    body.SetUserData({\n      impulse: false,\n      rotate: true,\n      spinFactor: 1,\n      ...object.userData,\n      uuid: object.uuid,\n    });\n    // bodyDef.SetAngle(object.angle || 0)\n\n    // refs[object.uuid] = {\n    //   object,\n    //   body,\n    // }\n    return body\n  }\n\n  function getPhysicsUserData (uuid) {\n    if (!refs.hasOwnProperty(uuid)) return {}\n    return refs[uuid].body.GetUserData()\n  }\n  return {\n    impulse,\n    rotate,\n    freeze,\n    unfreeze,\n    destroy,\n    restart,\n    createCharacter,\n    grow,\n    revertSpin,\n    overchargePower,\n    dischargePower,\n    overchargeFreezer,\n    dischargeFreeze,\n    hyperJump,\n    outOfThisWorld,\n    getPhysicsUserData,\n  }\n}\n\nfunction useBody(\n  type,\n  config,\n  fwdRef\n) {\n  const localRef = useRef(null)\n  const ref = fwdRef ? fwdRef : localRef\n  const api = useApi()\n  const { world, refs } = useContext(context)\n  // const [body, setBody] = useState()\n  // const [object, setObject] = useState()\n  // const [impulse, setImpulse] = useState(true)\n\n  useEffect(() => {\n    if (!ref.current || !world) {\n      return\n      // When the reference isn't used we create a stub\n      // The body doesn't have a visual representation but can still be constrained\n      // ref.current = new THREE.Object3D()\n    }\n    \n    const object = ref.current\n    if (!refs.hasOwnProperty(object.uuid)) {\n      const body = api.createCharacter(object, type, world);\n      refs[object.uuid] = { object, body }\n    }\n  }, [world])\n  \n  return [ref, api]\n}\n\nexport function useCircle(config, fwdRef) {\n  return useBody('circle', config, fwdRef)\n}\nexport function useBox(config, fwdRef) {\n  return useBody('box', config, fwdRef)\n}","import React, { useContext, useEffect } from 'react'\nimport { context } from './index'\n\nexport function useEvents (evntName, callback) {\n  const eventsManager = useContext(context)\n  useEffect(() => {\n    let unsubscribeEvent\n    if (callback) {\n      unsubscribeEvent = eventsManager.addEventListener(evntName, callback)\n    }\n    \n    return () => {\n      unsubscribeEvent && unsubscribeEvent()\n    }\n  },[evntName, callback])\n\n  return eventPayload => eventsManager.dispatch(evntName, eventPayload)\n}","import React, { useRef, forwardRef, useState, useEffect, useMemo } from 'react'\nimport { useLoader } from 'react-three-fiber'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/enemy_flat/enemy_ufoPurple.obj'\nimport modelMtl from '../../../assets/enemy_flat/enemy_ufoPurple.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\n// const assetURL = 'https://raw.githubusercontent.com/Cosmitar/threejs_assets/master/ufo_ships/enemy_ufoPurple.glb'\n\nconst getGradientMap = color => {\n  const alphaIndex = 1\n  const colors = new Uint8Array( alphaIndex + 2 )\n\n  for ( let c = 0; c <= colors.length; c ++ ) {\n\n    colors[ c ] = ( c / colors.length ) * 256;\n\n  }\n\n  const gradientMap = new THREE.DataTexture( colors, colors.length, 1, THREE.LuminanceFormat );\n  gradientMap.minFilter = THREE.NearestFilter;\n  gradientMap.magFilter = THREE.NearestFilter;\n  gradientMap.generateMipmaps = false;\n  return gradientMap\n}\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const matTest = new THREE.MeshBasicMaterial({ color: 'lime' })\n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[1] })\n  const materialCore = colorPalette[2] ? new THREE.MeshToonMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[2] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[3] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialChassis// snowRoad\n    obj.children[0].material[1] = materialDeco// purple\n    obj.children[0].material[2] = materialCore// stoneDark\n    obj.children[0].material[3] = materialDome// glass\n\n    obj.children[0].castShadow = true\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return useMemo(() =>\n    <group\n      ref={fwdRef}\n      {...moreProps}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n    </group>\n  , [geometry])\n})","import React, { useRef, forwardRef, useState, useEffect, useMemo } from 'react'\nimport { useLoader } from 'react-three-fiber'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/enemy_bubble/enemy_ufoGreen.obj'\nimport modelMtl from '../../../assets/enemy_bubble/enemy_ufoGreen.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\n// const assetURL = 'https://raw.githubusercontent.com/Cosmitar/threejs_assets/master/ufo_ships/enemy_ufoPurple.glb'\n\nconst getGradientMap = color => {\n  const alphaIndex = 1\n  const colors = new Uint8Array( alphaIndex + 2 )\n\n  for ( let c = 0; c <= colors.length; c ++ ) {\n\n    colors[ c ] = ( c / colors.length ) * 256;\n\n  }\n\n  const gradientMap = new THREE.DataTexture( colors, colors.length, 1, THREE.LuminanceFormat );\n  gradientMap.minFilter = THREE.NearestFilter;\n  gradientMap.magFilter = THREE.NearestFilter;\n  gradientMap.generateMipmaps = false;\n  return gradientMap\n}\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const matTest = new THREE.MeshBasicMaterial({ color: 'lime' })\n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[1] })\n  const materialCore = colorPalette[2] ? new THREE.MeshToonMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[2] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[3] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialChassis// snowRoad\n    obj.children[0].material[1] = materialDome// glass\n    obj.children[0].material[2] = materialDeco// foliage\n\n    obj.children[0].castShadow = true\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return useMemo(() =>\n    <group\n      ref={fwdRef}\n      {...moreProps}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n    </group>\n  , [geometry])\n})","import React, { useRef, forwardRef, useState, useEffect, useMemo } from 'react'\nimport { useLoader } from 'react-three-fiber'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/enemy_pill/enemy_ufoRed.obj'\nimport modelMtl from '../../../assets/enemy_pill/enemy_ufoRed.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\n// const assetURL = 'https://raw.githubusercontent.com/Cosmitar/threejs_assets/master/ufo_ships/enemy_ufoPurple.glb'\n\nconst getGradientMap = color => {\n  const alphaIndex = 1\n  const colors = new Uint8Array( alphaIndex + 2 )\n\n  for ( let c = 0; c <= colors.length; c ++ ) {\n\n    colors[ c ] = ( c / colors.length ) * 256;\n\n  }\n\n  const gradientMap = new THREE.DataTexture( colors, colors.length, 1, THREE.LuminanceFormat );\n  gradientMap.minFilter = THREE.NearestFilter;\n  gradientMap.magFilter = THREE.NearestFilter;\n  gradientMap.generateMipmaps = false;\n  return gradientMap\n}\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const matTest = new THREE.MeshBasicMaterial({ color: 'lime' })\n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[1] })\n  const materialCore = colorPalette[2] ? new THREE.MeshToonMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[2] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[3] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialDome// glass\n    obj.children[0].material[1] = materialChassis// snowRoadDark\n    obj.children[0].material[2] = materialDeco// stoneDark\n    obj.children[0].material[3] = materialDeco// red\n\n    obj.children[0].castShadow = true\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return useMemo(() =>\n    <group\n      ref={fwdRef}\n      {...moreProps}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n    </group>\n  , [geometry])\n})","import React, { useRef, forwardRef, useState, useEffect, useMemo } from 'react'\nimport { useLoader } from 'react-three-fiber'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/enemy_burger/enemy_ufoYellow.obj'\nimport modelMtl from '../../../assets/enemy_burger/enemy_ufoYellow.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\n// const assetURL = 'https://raw.githubusercontent.com/Cosmitar/threejs_assets/master/ufo_ships/enemy_ufoPurple.glb'\n\nconst getGradientMap = color => {\n  const alphaIndex = 1\n  const colors = new Uint8Array( alphaIndex + 2 )\n\n  for ( let c = 0; c <= colors.length; c ++ ) {\n\n    colors[ c ] = ( c / colors.length ) * 256;\n\n  }\n\n  const gradientMap = new THREE.DataTexture( colors, colors.length, 1, THREE.LuminanceFormat );\n  gradientMap.minFilter = THREE.NearestFilter;\n  gradientMap.magFilter = THREE.NearestFilter;\n  gradientMap.generateMipmaps = false;\n  return gradientMap\n}\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const matTest = new THREE.MeshBasicMaterial({ color: 'lime' })\n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[1] })\n  const materialCore = colorPalette[2] ? new THREE.MeshToonMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[2] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[3] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialDome// glass\n    obj.children[0].material[1] = materialChassis// snowRoadDark\n    obj.children[0].material[2] = materialDeco// stoneDark\n    obj.children[0].material[3] = materialDeco// red\n\n    obj.children[0].castShadow = true\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return useMemo(() =>\n    <group\n      ref={fwdRef}\n      {...moreProps}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n    </group>\n  , [geometry])\n})","// Defaults\nclass SVGElement {}\nclass HTMLInputElement {}\nclass NodeList {}\nclass HTMLCollection {}\n\nconst defaultInstanceSettings = {\n  update: null,\n  begin: null,\n  loopBegin: null,\n  changeBegin: null,\n  change: null,\n  changeComplete: null,\n  loopComplete: null,\n  complete: null,\n  loop: 1,\n  direction: 'normal',\n  autoplay: true,\n  timelineOffset: 0\n}\n\nconst defaultTweenSettings = {\n  duration: 1000,\n  delay: 0,\n  endDelay: 0,\n  easing: 'easeOutElastic(1, .5)',\n  round: 0\n}\n\nconst validTransforms = ['translateX', 'translateY', 'translateZ', 'rotate', 'rotateX', 'rotateY', 'rotateZ', 'scale', 'scaleX', 'scaleY', 'scaleZ', 'skew', 'skewX', 'skewY', 'perspective', 'matrix', 'matrix3d'];\n\n// Caching\n\nconst cache = {\n  CSS: {},\n  springs: {}\n}\n\n// Utils\n\nfunction minMax(val, min, max) {\n  return Math.min(Math.max(val, min), max);\n}\n\nfunction stringContains(str, text) {\n  return str.indexOf(text) > -1;\n}\n\nfunction applyArguments(func, args) {\n  return func.apply(null, args);\n}\n\nconst is = {\n  arr: a => Array.isArray(a),\n  obj: a => stringContains(Object.prototype.toString.call(a), 'Object'),\n  pth: a => is.obj(a) && a.hasOwnProperty('totalLength'),\n  svg: a => a instanceof SVGElement,\n  inp: a => a instanceof HTMLInputElement,\n  dom: a => a.nodeType || is.svg(a),\n  str: a => typeof a === 'string',\n  fnc: a => typeof a === 'function',\n  und: a => typeof a === 'undefined',\n  hex: a => /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a),\n  rgb: a => /^rgb/.test(a),\n  hsl: a => /^hsl/.test(a),\n  col: a => (is.hex(a) || is.rgb(a) || is.hsl(a)),\n  key: a => !defaultInstanceSettings.hasOwnProperty(a) && !defaultTweenSettings.hasOwnProperty(a) && a !== 'targets' && a !== 'keyframes'\n}\n\n// Easings\n\nfunction parseEasingParameters(string) {\n  const match = /\\(([^)]+)\\)/.exec(string);\n  return match ? match[1].split(',').map(p => parseFloat(p)) : [];\n}\n\n// Spring solver inspired by Webkit Copyright © 2016 Apple Inc. All rights reserved. https://webkit.org/demos/spring/spring.js\n\nfunction spring(string, duration) {\n\n  const params = parseEasingParameters(string);\n  const mass = minMax(is.und(params[0]) ? 1 : params[0], .1, 100);\n  const stiffness = minMax(is.und(params[1]) ? 100 : params[1], .1, 100);\n  const damping = minMax(is.und(params[2]) ? 10 : params[2], .1, 100);\n  const velocity = minMax(is.und(params[3]) ? 0 : params[3], .1, 100);\n  const w0 = Math.sqrt(stiffness / mass);\n  const zeta = damping / (2 * Math.sqrt(stiffness * mass));\n  const wd = zeta < 1 ? w0 * Math.sqrt(1 - zeta * zeta) : 0;\n  const a = 1;\n  const b = zeta < 1 ? (zeta * w0 + -velocity) / wd : -velocity + w0;\n\n  function solver(t) {\n    let progress = duration ? (duration * t) / 1000 : t;\n    if (zeta < 1) {\n      progress = Math.exp(-progress * zeta * w0) * (a * Math.cos(wd * progress) + b * Math.sin(wd * progress));\n    } else {\n      progress = (a + b * progress) * Math.exp(-progress * w0);\n    }\n    if (t === 0 || t === 1) return t;\n    return 1 - progress;\n  }\n\n  function getDuration() {\n    const cached = cache.springs[string];\n    if (cached) return cached;\n    const frame = 1 / 6;\n    let elapsed = 0;\n    let rest = 0;\n    while (true) {\n      elapsed += frame;\n      if (solver(elapsed) === 1) {\n        rest++;\n        if (rest >= 16) break;\n      } else {\n        rest = 0;\n      }\n    }\n    const duration = elapsed * frame * 1000;\n    cache.springs[string] = duration;\n    return duration;\n  }\n\n  return duration ? solver : getDuration;\n\n}\n\n// Basic steps easing implementation https://developer.mozilla.org/fr/docs/Web/CSS/transition-timing-function\n\nfunction steps(steps = 10) {\n  return t => Math.ceil((minMax(t, 0.000001, 1)) * steps) * (1 / steps);\n}\n\n// BezierEasing https://github.com/gre/bezier-easing\n\nconst bezier = (() => {\n\n  const kSplineTableSize = 11;\n  const kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\n  function A(aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1 };\n  function B(aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1 };\n  function C(aA1) { return 3.0 * aA1 };\n\n  function calcBezier(aT, aA1, aA2) { return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT };\n  function getSlope(aT, aA1, aA2) { return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1) };\n\n  function binarySubdivide(aX, aA, aB, mX1, mX2) {\n    let currentX, currentT, i = 0;\n    do {\n      currentT = aA + (aB - aA) / 2.0;\n      currentX = calcBezier(currentT, mX1, mX2) - aX;\n      if (currentX > 0.0) { aB = currentT } else { aA = currentT };\n    } while (Math.abs(currentX) > 0.0000001 && ++i < 10);\n    return currentT;\n  }\n\n  function newtonRaphsonIterate(aX, aGuessT, mX1, mX2) {\n    for (let i = 0; i < 4; ++i) {\n      const currentSlope = getSlope(aGuessT, mX1, mX2);\n      if (currentSlope === 0.0) return aGuessT;\n      const currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n      aGuessT -= currentX / currentSlope;\n    }\n    return aGuessT;\n  }\n\n  function bezier(mX1, mY1, mX2, mY2) {\n\n    if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) return;\n    let sampleValues = new Float32Array(kSplineTableSize);\n\n    if (mX1 !== mY1 || mX2 !== mY2) {\n      for (let i = 0; i < kSplineTableSize; ++i) {\n        sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n      }\n    }\n\n    function getTForX(aX) {\n\n      let intervalStart = 0;\n      let currentSample = 1;\n      const lastSample = kSplineTableSize - 1;\n\n      for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n        intervalStart += kSampleStepSize;\n      }\n\n      --currentSample;\n\n      const dist = (aX - sampleValues[currentSample]) / (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n      const guessForT = intervalStart + dist * kSampleStepSize;\n      const initialSlope = getSlope(guessForT, mX1, mX2);\n\n      if (initialSlope >= 0.001) {\n        return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n      } else if (initialSlope === 0.0) {\n        return guessForT;\n      } else {\n        return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n      }\n\n    }\n\n    return x => {\n      if (mX1 === mY1 && mX2 === mY2) return x;\n      if (x === 0 || x === 1) return x;\n      return calcBezier(getTForX(x), mY1, mY2);\n    }\n\n  }\n\n  return bezier;\n\n})();\n\nconst penner = (() => {\n\n  // Based on jQuery UI's implemenation of easing equations from Robert Penner (http://www.robertpenner.com/easing)\n\n  const eases = { linear: () => t => t };\n\n  const functionEasings = {\n    Sine: () => t => 1 - Math.cos(t * Math.PI / 2),\n    Circ: () => t => 1 - Math.sqrt(1 - t * t),\n    Back: () => t => t * t * (3 * t - 2),\n    Bounce: () => t => {\n      let pow2, b = 4;\n      while (t < ((pow2 = Math.pow(2, --b)) - 1) / 11) { };\n      return 1 / Math.pow(4, 3 - b) - 7.5625 * Math.pow((pow2 * 3 - 2) / 22 - t, 2)\n    },\n    Elastic: (amplitude = 1, period = .5) => {\n      const a = minMax(amplitude, 1, 10);\n      const p = minMax(period, .1, 2);\n      return t => {\n        return (t === 0 || t === 1) ? t :\n          -a * Math.pow(2, 10 * (t - 1)) * Math.sin((((t - 1) - (p / (Math.PI * 2) * Math.asin(1 / a))) * (Math.PI * 2)) / p);\n      }\n    }\n  }\n\n  const baseEasings = ['Quad', 'Cubic', 'Quart', 'Quint', 'Expo'];\n\n  baseEasings.forEach((name, i) => {\n    functionEasings[name] = () => t => Math.pow(t, i + 2);\n  });\n\n  Object.keys(functionEasings).forEach(name => {\n    const easeIn = functionEasings[name];\n    eases['easeIn' + name] = easeIn;\n    eases['easeOut' + name] = (a, b) => t => 1 - easeIn(a, b)(1 - t);\n    eases['easeInOut' + name] = (a, b) => t => t < 0.5 ? easeIn(a, b)(t * 2) / 2 :\n      1 - easeIn(a, b)(t * -2 + 2) / 2;\n  });\n\n  return eases;\n\n})();\n\nfunction parseEasings(easing, duration) {\n  if (is.fnc(easing)) return easing;\n  const name = easing.split('(')[0];\n  const ease = penner[name];\n  const args = parseEasingParameters(easing);\n  switch (name) {\n    case 'spring': return spring(easing, duration);\n    case 'cubicBezier': return applyArguments(bezier, args);\n    case 'steps': return applyArguments(steps, args);\n    default: return applyArguments(ease, args);\n  }\n}\n\n// Strings\n\nfunction selectString(str) {\n  try {\n    // let nodes = document.querySelectorAll(str);\n    return str;\n  } catch (e) {\n    return;\n  }\n}\n\n// Arrays\n\nfunction filterArray(arr, callback) {\n  const len = arr.length;\n  const thisArg = arguments.length >= 2 ? arguments[1] : void 0;\n  const result = [];\n  for (let i = 0; i < len; i++) {\n    if (i in arr) {\n      const val = arr[i];\n      if (callback.call(thisArg, val, i, arr)) {\n        result.push(val);\n      }\n    }\n  }\n  return result;\n}\n\nfunction flattenArray(arr) {\n  return arr.reduce((a, b) => a.concat(is.arr(b) ? flattenArray(b) : b), []);\n}\n\nfunction toArray(o) {\n  if (is.arr(o)) return o;\n  // if (is.str(o)) o = selectString(o) || o;\n  // if (o instanceof NodeList || o instanceof HTMLCollection) return [].slice.call(o);\n  return [o];\n}\n\nfunction arrayContains(arr, val) {\n  return arr.some(a => a === val);\n}\n\n// Objects\n\nfunction cloneObject(o) {\n  const clone = {};\n  for (let p in o) clone[p] = o[p];\n  return clone;\n}\n\nfunction replaceObjectProps(o1, o2) {\n  const o = cloneObject(o1);\n  for (let p in o1) o[p] = o2.hasOwnProperty(p) ? o2[p] : o1[p];\n  return o;\n}\n\nfunction mergeObjects(o1, o2) {\n  const o = cloneObject(o1);\n  for (let p in o2) o[p] = is.und(o1[p]) ? o2[p] : o1[p];\n  return o;\n}\n\n// Colors\n\nfunction rgbToRgba(rgbValue) {\n  const rgb = /rgb\\((\\d+,\\s*[\\d]+,\\s*[\\d]+)\\)/g.exec(rgbValue);\n  return rgb ? `rgba(${rgb[1]},1)` : rgbValue;\n}\n\nfunction hexToRgba(hexValue) {\n  const rgx = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  const hex = hexValue.replace(rgx, (m, r, g, b) => r + r + g + g + b + b);\n  const rgb = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  const r = parseInt(rgb[1], 16);\n  const g = parseInt(rgb[2], 16);\n  const b = parseInt(rgb[3], 16);\n  return `rgba(${r},${g},${b},1)`;\n}\n\nfunction hslToRgba(hslValue) {\n  const hsl = /hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/g.exec(hslValue) || /hsla\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%,\\s*([\\d.]+)\\)/g.exec(hslValue);\n  const h = parseInt(hsl[1], 10) / 360;\n  const s = parseInt(hsl[2], 10) / 100;\n  const l = parseInt(hsl[3], 10) / 100;\n  const a = hsl[4] || 1;\n  function hue2rgb(p, q, t) {\n    if (t < 0) t += 1;\n    if (t > 1) t -= 1;\n    if (t < 1 / 6) return p + (q - p) * 6 * t;\n    if (t < 1 / 2) return q;\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n    return p;\n  }\n  let r, g, b;\n  if (s == 0) {\n    r = g = b = l;\n  } else {\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n  return `rgba(${r * 255},${g * 255},${b * 255},${a})`;\n}\n\nfunction colorToRgb(val) {\n  if (is.rgb(val)) return rgbToRgba(val);\n  if (is.hex(val)) return hexToRgba(val);\n  if (is.hsl(val)) return hslToRgba(val);\n}\n\n// Units\n\nfunction getUnit(val) {\n  const split = /[+-]?\\d*\\.?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(val);\n  if (split) return split[1];\n}\n\nfunction getTransformUnit(propName) {\n  if (stringContains(propName, 'translate') || propName === 'perspective') return 'px';\n  if (stringContains(propName, 'rotate') || stringContains(propName, 'skew')) return 'deg';\n}\n\n// Values\n\nfunction getFunctionValue(val, animatable) {\n  if (!is.fnc(val)) return val;\n  return val(animatable.target, animatable.id, animatable.total);\n}\n\nfunction getAttribute(el, prop) {\n  return el.getAttribute(prop);\n}\n\nfunction convertPxToUnit(el, value, unit) {\n  const valueUnit = getUnit(value);\n  if (arrayContains([unit, 'deg', 'rad', 'turn'], valueUnit)) return value;\n  const cached = cache.CSS[value + unit];\n  if (!is.und(cached)) return cached;\n  const baseline = 100;\n  const tempEl = null; // document.createElement(el.tagName);\n  const parentEl = null; // (el.parentNode && (el.parentNode !== document)) ? el.parentNode : document.body;\n  parentEl.appendChild(tempEl);\n  tempEl.style.position = 'absolute';\n  tempEl.style.width = baseline + unit;\n  const factor = baseline / tempEl.offsetWidth;\n  parentEl.removeChild(tempEl);\n  const convertedUnit = factor * parseFloat(value);\n  cache.CSS[value + unit] = convertedUnit;\n  return convertedUnit;\n}\n\nfunction getCSSValue(el, prop, unit) {\n  if (prop in el.style) {\n    const uppercasePropName = prop.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n    const value = el.style[prop] || getComputedStyle(el).getPropertyValue(uppercasePropName) || '0';\n    return unit ? convertPxToUnit(el, value, unit) : value;\n  }\n}\n\nfunction getAnimationType(el, prop) {\n  return 'object';\n  if (is.dom(el) && !is.inp(el) && (getAttribute(el, prop) || (is.svg(el) && el[prop]))) return 'attribute';\n  if (is.dom(el) && arrayContains(validTransforms, prop)) return 'transform';\n  if (is.dom(el) && (prop !== 'transform' && getCSSValue(el, prop))) return 'css';\n  if (el[prop] != null) return 'object';\n}\n\nfunction getElementTransforms(el) {\n  if (!is.dom(el)) return;\n  const str = el?.style?.transform || '';\n  const reg = /(\\w+)\\(([^)]*)\\)/g;\n  const transforms = new Map();\n  let m; while (m = reg.exec(str)) transforms.set(m[1], m[2]);\n  return transforms;\n}\n\nfunction getTransformValue(el, propName, animatable, unit) {\n  const defaultVal = stringContains(propName, 'scale') ? 1 : 0 + getTransformUnit(propName);\n  const value = getElementTransforms(el).get(propName) || defaultVal;\n  if (animatable) {\n    animatable.transforms.list.set(propName, value);\n    animatable.transforms['last'] = propName;\n  }\n  return unit ? convertPxToUnit(el, value, unit) : value;\n}\n\nfunction getOriginalTargetValue(target, propName, unit, animatable) {\n  switch (getAnimationType(target, propName)) {\n    case 'transform': return getTransformValue(target, propName, animatable, unit);\n    case 'css': return getCSSValue(target, propName, unit);\n    case 'attribute': return getAttribute(target, propName);\n    default: return target[propName] || 0;\n  }\n}\n\nfunction getRelativeValue(to, from) {\n  const operator = /^(\\*=|\\+=|-=)/.exec(to);\n  if (!operator) return to;\n  const u = getUnit(to) || 0;\n  const x = parseFloat(from);\n  const y = parseFloat(to.replace(operator[0], ''));\n  switch (operator[0][0]) {\n    case '+': return x + y + u;\n    case '-': return x - y + u;\n    case '*': return x * y + u;\n  }\n}\n\nfunction validateValue(val, unit) {\n  if (is.col(val)) return colorToRgb(val);\n  if (/\\s/g.test(val)) return val;\n  const originalUnit = getUnit(val);\n  const unitLess = originalUnit ? val.substr(0, val.length - originalUnit.length) : val;\n  if (unit) return unitLess + unit;\n  return unitLess;\n}\n\n// getTotalLength() equivalent for circle, rect, polyline, polygon and line shapes\n// adapted from https://gist.github.com/SebLambla/3e0550c496c236709744\n\nfunction getDistance(p1, p2) {\n  return Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2));\n}\n\nfunction getCircleLength(el) {\n  return Math.PI * 2 * getAttribute(el, 'r');\n}\n\nfunction getRectLength(el) {\n  return (getAttribute(el, 'width') * 2) + (getAttribute(el, 'height') * 2);\n}\n\nfunction getLineLength(el) {\n  return getDistance(\n    { x: getAttribute(el, 'x1'), y: getAttribute(el, 'y1') },\n    { x: getAttribute(el, 'x2'), y: getAttribute(el, 'y2') }\n  );\n}\n\nfunction getPolylineLength(el) {\n  const points = el.points;\n  let totalLength = 0;\n  let previousPos;\n  for (let i = 0; i < points.numberOfItems; i++) {\n    const currentPos = points.getItem(i);\n    if (i > 0) totalLength += getDistance(previousPos, currentPos);\n    previousPos = currentPos;\n  }\n  return totalLength;\n}\n\nfunction getPolygonLength(el) {\n  const points = el.points;\n  return getPolylineLength(el) + getDistance(points.getItem(points.numberOfItems - 1), points.getItem(0));\n}\n\n// Path animation\n\nfunction getTotalLength(el) {\n  if (el.getTotalLength) return el.getTotalLength();\n  switch (el.tagName.toLowerCase()) {\n    case 'circle': return getCircleLength(el);\n    case 'rect': return getRectLength(el);\n    case 'line': return getLineLength(el);\n    case 'polyline': return getPolylineLength(el);\n    case 'polygon': return getPolygonLength(el);\n  }\n}\n\nfunction setDashoffset(el) {\n  const pathLength = getTotalLength(el);\n  el.setAttribute('stroke-dasharray', pathLength);\n  return pathLength;\n}\n\n// Motion path\n\nfunction getParentSvgEl(el) {\n  let parentEl = el.parentNode;\n  while (is.svg(parentEl)) {\n    if (!is.svg(parentEl.parentNode)) break;\n    parentEl = parentEl.parentNode;\n  }\n  return parentEl;\n}\n\nfunction getParentSvg(pathEl, svgData) {\n  const svg = svgData || {};\n  const parentSvgEl = svg.el || getParentSvgEl(pathEl);\n  const rect = parentSvgEl.getBoundingClientRect();\n  const viewBoxAttr = getAttribute(parentSvgEl, 'viewBox');\n  const width = rect.width;\n  const height = rect.height;\n  const viewBox = svg.viewBox || (viewBoxAttr ? viewBoxAttr.split(' ') : [0, 0, width, height]);\n  return {\n    el: parentSvgEl,\n    viewBox: viewBox,\n    x: viewBox[0] / 1,\n    y: viewBox[1] / 1,\n    w: width / viewBox[2],\n    h: height / viewBox[3]\n  }\n}\n\nfunction getPath(path, percent) {\n  const pathEl = is.str(path) ? selectString(path)[0] : path;\n  const p = percent || 100;\n  return function (property) {\n    return {\n      property,\n      el: pathEl,\n      svg: getParentSvg(pathEl),\n      totalLength: getTotalLength(pathEl) * (p / 100)\n    }\n  }\n}\n\nfunction getPathProgress(path, progress) {\n  function point(offset = 0) {\n    const l = progress + offset >= 1 ? progress + offset : 0;\n    return path.el.getPointAtLength(l);\n  }\n  const svg = getParentSvg(path.el, path.svg)\n  const p = point();\n  const p0 = point(-1);\n  const p1 = point(+1);\n  switch (path.property) {\n    case 'x': return (p.x - svg.x) * svg.w;\n    case 'y': return (p.y - svg.y) * svg.h;\n    case 'angle': return Math.atan2(p1.y - p0.y, p1.x - p0.x) * 180 / Math.PI;\n  }\n}\n\n// Decompose value\n\nfunction decomposeValue(val, unit) {\n  // const rgx = /-?\\d*\\.?\\d+/g; // handles basic numbers\n  // const rgx = /[+-]?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?/g; // handles exponents notation\n  const rgx = /[+-]?\\d*\\.?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?/g; // handles exponents notation\n  const value = validateValue((is.pth(val) ? val.totalLength : val), unit) + '';\n  return {\n    original: value,\n    numbers: value.match(rgx) ? value.match(rgx).map(Number) : [0],\n    strings: (is.str(val) || unit) ? value.split(rgx) : []\n  }\n}\n\n// Animatables\n\nfunction parseTargets(targets) {\n  const targetsArray = targets ? (flattenArray(is.arr(targets) ? targets.map(toArray) : toArray(targets))) : [];\n  return filterArray(targetsArray, (item, pos, self) => self.indexOf(item) === pos);\n}\n\nfunction getAnimatables(targets) {\n  const parsed = parseTargets(targets);\n  return parsed.map((t, i) => {\n    return { target: t, id: i, total: parsed.length, transforms: { list: getElementTransforms(t) } };\n  });\n}\n\n// Properties\n\nfunction normalizePropertyTweens(prop, tweenSettings) {\n  let settings = cloneObject(tweenSettings);\n  // Override duration if easing is a spring\n  if (/^spring/.test(settings.easing)) settings.duration = spring(settings.easing);\n  if (is.arr(prop)) {\n    const l = prop.length;\n    const isFromTo = (l === 2 && !is.obj(prop[0]));\n    if (!isFromTo) {\n      // Duration divided by the number of tweens\n      if (!is.fnc(tweenSettings.duration)) settings.duration = tweenSettings.duration / l;\n    } else {\n      // Transform [from, to] values shorthand to a valid tween value\n      prop = { value: prop };\n    }\n  }\n  const propArray = is.arr(prop) ? prop : [prop];\n  return propArray.map((v, i) => {\n    const obj = (is.obj(v) && !is.pth(v)) ? v : { value: v };\n    // Default delay value should only be applied to the first tween\n    if (is.und(obj.delay)) obj.delay = !i ? tweenSettings.delay : 0;\n    // Default endDelay value should only be applied to the last tween\n    if (is.und(obj.endDelay)) obj.endDelay = i === propArray.length - 1 ? tweenSettings.endDelay : 0;\n    return obj;\n  }).map(k => mergeObjects(k, settings));\n}\n\n\nfunction flattenKeyframes(keyframes) {\n  const propertyNames = filterArray(flattenArray(keyframes.map(key => Object.keys(key))), p => is.key(p))\n    .reduce((a, b) => { if (a.indexOf(b) < 0) a.push(b); return a; }, []);\n  const properties = {};\n  for (let i = 0; i < propertyNames.length; i++) {\n    const propName = propertyNames[i];\n    properties[propName] = keyframes.map(key => {\n      const newKey = {};\n      for (let p in key) {\n        if (is.key(p)) {\n          if (p == propName) newKey.value = key[p];\n        } else {\n          newKey[p] = key[p];\n        }\n      }\n      return newKey;\n    });\n  }\n  return properties;\n}\n\nfunction getProperties(tweenSettings, params) {\n  const properties = [];\n  const keyframes = params.keyframes;\n  if (keyframes) params = mergeObjects(flattenKeyframes(keyframes), params);;\n  for (let p in params) {\n    if (is.key(p)) {\n      properties.push({\n        name: p,\n        tweens: normalizePropertyTweens(params[p], tweenSettings)\n      });\n    }\n  }\n  return properties;\n}\n\n// Tweens\n\nfunction normalizeTweenValues(tween, animatable) {\n  const t = {};\n  for (let p in tween) {\n    let value = getFunctionValue(tween[p], animatable);\n    if (is.arr(value)) {\n      value = value.map(v => getFunctionValue(v, animatable));\n      if (value.length === 1) value = value[0];\n    }\n    t[p] = value;\n  }\n  t.duration = parseFloat(t.duration);\n  t.delay = parseFloat(t.delay);\n  return t;\n}\n\nfunction normalizeTweens(prop, animatable) {\n  let previousTween;\n  return prop.tweens.map(t => {\n    const tween = normalizeTweenValues(t, animatable);\n    const tweenValue = tween.value;\n    let to = is.arr(tweenValue) ? tweenValue[1] : tweenValue;\n    const toUnit = getUnit(to);\n    const originalValue = getOriginalTargetValue(animatable.target, prop.name, toUnit, animatable);\n    const previousValue = previousTween ? previousTween.to.original : originalValue;\n    const from = is.arr(tweenValue) ? tweenValue[0] : previousValue;\n    const fromUnit = getUnit(from) || getUnit(originalValue);\n    const unit = toUnit || fromUnit;\n    if (is.und(to)) to = previousValue;\n    tween.from = decomposeValue(from, unit);\n    tween.to = decomposeValue(getRelativeValue(to, from), unit);\n    tween.start = previousTween ? previousTween.end : 0;\n    tween.end = tween.start + tween.delay + tween.duration + tween.endDelay;\n    tween.easing = parseEasings(tween.easing, tween.duration);\n    tween.isPath = is.pth(tweenValue);\n    tween.isColor = is.col(tween.from.original);\n    if (tween.isColor) tween.round = 1;\n    previousTween = tween;\n    return tween;\n  });\n}\n\n// Tween progress\n\nconst setProgressValue = {\n  css: (t, p, v) => t.style[p] = v,\n  attribute: (t, p, v) => t.setAttribute(p, v),\n  object: (t, p, v) => t[p] = v,\n  transform: (t, p, v, transforms, manual) => {\n    transforms.list.set(p, v);\n    if (p === transforms.last || manual) {\n      let str = '';\n      transforms.list.forEach((value, prop) => { str += `${prop}(${value}) `; });\n      t.style.transform = str;\n    }\n  }\n}\n\n// Set Value helper\n\nfunction setTargetsValue(targets, properties) {\n  const animatables = getAnimatables(targets);\n  animatables.forEach(animatable => {\n    for (let property in properties) {\n      const value = getFunctionValue(properties[property], animatable);\n      const target = animatable.target;\n      const valueUnit = getUnit(value);\n      const originalValue = getOriginalTargetValue(target, property, valueUnit, animatable);\n      const unit = valueUnit || getUnit(originalValue);\n      const to = getRelativeValue(validateValue(value, unit), originalValue);\n      const animType = getAnimationType(target, property);\n      setProgressValue[animType](target, property, to, animatable.transforms, true);\n    }\n  });\n}\n\n// Animations\n\nfunction createAnimation(animatable, prop) {\n  const animType = getAnimationType(animatable.target, prop.name);\n  if (animType) {\n    const tweens = normalizeTweens(prop, animatable);\n    const lastTween = tweens[tweens.length - 1];\n    return {\n      type: animType,\n      property: prop.name,\n      animatable: animatable,\n      tweens: tweens,\n      duration: lastTween.end,\n      delay: tweens[0].delay,\n      endDelay: lastTween.endDelay\n    }\n  }\n}\n\nfunction getAnimations(animatables, properties) {\n  return filterArray(flattenArray(animatables.map(animatable => {\n    return properties.map(prop => {\n      return createAnimation(animatable, prop);\n    });\n  })), a => !is.und(a));\n}\n\n// Create Instance\n\nfunction getInstanceTimings(animations, tweenSettings) {\n  const animLength = animations.length;\n  const getTlOffset = anim => anim.timelineOffset ? anim.timelineOffset : 0;\n  const timings = {};\n  timings.duration = animLength ? Math.max.apply(Math, animations.map(anim => getTlOffset(anim) + anim.duration)) : tweenSettings.duration;\n  timings.delay = animLength ? Math.min.apply(Math, animations.map(anim => getTlOffset(anim) + anim.delay)) : tweenSettings.delay;\n  timings.endDelay = animLength ? timings.duration - Math.max.apply(Math, animations.map(anim => getTlOffset(anim) + anim.duration - anim.endDelay)) : tweenSettings.endDelay;\n  return timings;\n}\n\nlet instanceID = 0;\n\nfunction createNewInstance(params) {\n  const instanceSettings = replaceObjectProps(defaultInstanceSettings, params);\n  const tweenSettings = replaceObjectProps(defaultTweenSettings, params);\n  const properties = getProperties(tweenSettings, params);\n  const animatables = getAnimatables(params.targets);\n  const animations = getAnimations(animatables, properties);\n  const timings = getInstanceTimings(animations, tweenSettings);\n  const id = instanceID;\n  instanceID++;\n  return mergeObjects(instanceSettings, {\n    id: id,\n    children: [],\n    animatables: animatables,\n    animations: animations,\n    duration: timings.duration,\n    delay: timings.delay,\n    endDelay: timings.endDelay\n  });\n}\n\n// Core\n\nlet activeInstances = [];\nlet pausedInstances = [];\nlet raf;\n\nconst engine = (() => {\n  function play() {\n    raf = requestAnimationFrame(step);\n  }\n  function step(t) {\n    let activeInstancesLength = activeInstances.length;\n    if (activeInstancesLength) {\n      let i = 0;\n      while (i < activeInstancesLength) {\n        const activeInstance = activeInstances[i];\n        if (!activeInstance.paused) {\n          activeInstance.tick(t);\n        } else {\n          const instanceIndex = activeInstances.indexOf(activeInstance);\n          if (instanceIndex > -1) {\n            activeInstances.splice(instanceIndex, 1);\n            activeInstancesLength = activeInstances.length;\n          }\n        }\n        i++;\n      }\n      play();\n    } else {\n      raf = cancelAnimationFrame(raf);\n    }\n  }\n  return play;\n})();\n\nfunction handleVisibilityChange() {\n  if (false) {\n    activeInstances.forEach(ins => ins.pause());\n    pausedInstances = activeInstances.slice(0);\n    anime.running = activeInstances = [];\n  } else {\n    pausedInstances.forEach(ins => ins.play());\n  }\n}\n\nif (typeof document !== 'undefined') {\n  // document.addEventListener('visibilitychange', handleVisibilityChange);\n}\n\n// Public Instance\n\nfunction anime(params = {}) {\n  let startTime = 0, lastTime = 0, now = 0;\n  let children, childrenLength = 0;\n  let resolve = null;\n  \n  function makePromise(instance) {\n    const promise = new Promise(_resolve => resolve = _resolve);\n    instance.finished = promise;\n    return promise;\n  }\n  \n  let instance = createNewInstance(params);\n  let promise = makePromise(instance);\n\n  function toggleInstanceDirection() {\n    const direction = instance.direction;\n    if (direction !== 'alternate') {\n      instance.direction = direction !== 'normal' ? 'normal' : 'reverse';\n    }\n    instance.reversed = !instance.reversed;\n    children.forEach(child => child.reversed = instance.reversed);\n  }\n\n  function adjustTime(time) {\n    return instance.reversed ? instance.duration - time : time;\n  }\n\n  function resetTime() {\n    startTime = 0;\n    lastTime = adjustTime(instance.currentTime) * (1 / anime.speed);\n  }\n\n  function seekChild(time, child) {\n    if (child) child.seek(time - child.timelineOffset);\n  }\n\n  function syncInstanceChildren(time) {\n    if (!instance.reversePlayback) {\n      for (let i = 0; i < childrenLength; i++) seekChild(time, children[i]);\n    } else {\n      for (let i = childrenLength; i--;) seekChild(time, children[i]);\n    }\n  }\n\n  function setAnimationsProgress(insTime) {\n    let i = 0;\n    const animations = instance.animations;\n    const animationsLength = animations.length;\n    while (i < animationsLength) {\n      const anim = animations[i];\n      const animatable = anim.animatable;\n      const tweens = anim.tweens;\n      const tweenLength = tweens.length - 1;\n      let tween = tweens[tweenLength];\n      // Only check for keyframes if there is more than one tween\n      if (tweenLength) tween = filterArray(tweens, t => (insTime < t.end))[0] || tween;\n      const elapsed = minMax(insTime - tween.start - tween.delay, 0, tween.duration) / tween.duration;\n      const eased = isNaN(elapsed) ? 1 : tween.easing(elapsed);\n      const strings = tween.to.strings;\n      const round = tween.round;\n      const numbers = [];\n      const toNumbersLength = tween.to.numbers.length;\n      let progress;\n      for (let n = 0; n < toNumbersLength; n++) {\n        let value;\n        const toNumber = tween.to.numbers[n];\n        const fromNumber = tween.from.numbers[n] || 0;\n        if (!tween.isPath) {\n          value = fromNumber + (eased * (toNumber - fromNumber));\n        } else {\n          value = getPathProgress(tween.value, eased * toNumber);\n        }\n        if (round) {\n          if (!(tween.isColor && n > 2)) {\n            value = Math.round(value * round) / round;\n          }\n        }\n        numbers.push(value);\n      }\n      // Manual Array.reduce for better performances\n      const stringsLength = strings.length;\n      if (!stringsLength) {\n        progress = numbers[0];\n      } else {\n        progress = strings[0];\n        for (let s = 0; s < stringsLength; s++) {\n          const a = strings[s];\n          const b = strings[s + 1];\n          const n = numbers[s];\n          if (!isNaN(n)) {\n            if (!b) {\n              progress += n + ' ';\n            } else {\n              progress += n + b;\n            }\n          }\n        }\n      }\n      setProgressValue[anim.type](animatable.target, anim.property, progress, animatable.transforms);\n      anim.currentValue = progress;\n      i++;\n    }\n  }\n\n  function setCallback(cb) {\n    if (instance[cb] && !instance.passThrough) instance[cb](instance);\n  }\n\n  function countIteration() {\n    if (instance.remaining && instance.remaining !== true) {\n      instance.remaining--;\n    }\n  }\n\n  function setInstanceProgress(engineTime) {\n    const insDuration = instance.duration;\n    const insDelay = instance.delay;\n    const insEndDelay = insDuration - instance.endDelay;\n    const insTime = adjustTime(engineTime);\n    instance.progress = minMax((insTime / insDuration) * 100, 0, 100);\n    instance.reversePlayback = insTime < instance.currentTime;\n    if (children) { syncInstanceChildren(insTime); }\n    if (!instance.began && instance.currentTime > 0) {\n      instance.began = true;\n      setCallback('begin');\n    }\n    if (!instance.loopBegan && instance.currentTime > 0) {\n      instance.loopBegan = true;\n      setCallback('loopBegin');\n    }\n    if (insTime <= insDelay && instance.currentTime !== 0) {\n      setAnimationsProgress(0);\n    }\n    if ((insTime >= insEndDelay && instance.currentTime !== insDuration) || !insDuration) {\n      setAnimationsProgress(insDuration);\n    }\n    if (insTime > insDelay && insTime < insEndDelay) {\n      if (!instance.changeBegan) {\n        instance.changeBegan = true;\n        instance.changeCompleted = false;\n        setCallback('changeBegin');\n      }\n      setCallback('change');\n      setAnimationsProgress(insTime);\n    } else {\n      if (instance.changeBegan) {\n        instance.changeCompleted = true;\n        instance.changeBegan = false;\n        setCallback('changeComplete');\n      }\n    }\n    instance.currentTime = minMax(insTime, 0, insDuration);\n    if (instance.began) setCallback('update');\n    if (engineTime >= insDuration) {\n      lastTime = 0;\n      countIteration();\n      if (!instance.remaining) {\n        instance.paused = true;\n        if (!instance.completed) {\n          instance.completed = true;\n          setCallback('loopComplete');\n          setCallback('complete');\n          if (!instance.passThrough) {\n            resolve();\n            promise = makePromise(instance);\n          }\n        }\n      } else {\n        startTime = now;\n        setCallback('loopComplete');\n        instance.loopBegan = false;\n        if (instance.direction === 'alternate') {\n          toggleInstanceDirection();\n        }\n      }\n    }\n  }\n\n  instance.reset = function () {\n    const direction = instance.direction;\n    instance.passThrough = false;\n    instance.currentTime = 0;\n    instance.progress = 0;\n    instance.paused = true;\n    instance.began = false;\n    instance.loopBegan = false;\n    instance.changeBegan = false;\n    instance.completed = false;\n    instance.changeCompleted = false;\n    instance.reversePlayback = false;\n    instance.reversed = direction === 'reverse';\n    instance.remaining = instance.loop;\n    children = instance.children;\n    childrenLength = children.length;\n    for (let i = childrenLength; i--;) instance.children[i].reset();\n    if (instance.reversed && instance.loop !== true || (direction === 'alternate' && instance.loop === 1)) instance.remaining++;\n    setAnimationsProgress(instance.reversed ? instance.duration : 0);\n  }\n\n  // Set Value helper\n\n  instance.set = function (targets, properties) {\n    setTargetsValue(targets, properties);\n    return instance;\n  }\n\n  instance.tick = function (t) {\n    now = t;\n    if (!startTime) startTime = now;\n    setInstanceProgress((now + (lastTime - startTime)) * anime.speed);\n  }\n\n  instance.seek = function (time) {\n    setInstanceProgress(adjustTime(time));\n  }\n\n  instance.pause = function () {\n    instance.paused = true;\n    resetTime();\n  }\n\n  instance.play = function () {\n    if (!instance.paused) return;\n    if (instance.completed) instance.reset();\n    instance.paused = false;\n    activeInstances.push(instance);\n    resetTime();\n    if (!raf) engine();\n  }\n\n  instance.reverse = function () {\n    toggleInstanceDirection();\n    instance.completed = instance.reversed ? false : true;\n    resetTime();\n  }\n\n  instance.restart = function () {\n    instance.reset();\n    instance.play();\n  }\n\n  instance.reset();\n\n  if (instance.autoplay) instance.play();\n\n  return instance;\n\n}\n\n// Remove targets from animation\n\nfunction removeTargetsFromAnimations(targetsArray, animations) {\n  for (let a = animations.length; a--;) {\n    if (arrayContains(targetsArray, animations[a].animatable.target)) {\n      animations.splice(a, 1);\n    }\n  }\n}\n\nfunction removeTargets(targets) {\n  const targetsArray = parseTargets(targets);\n  for (let i = activeInstances.length; i--;) {\n    const instance = activeInstances[i];\n    const animations = instance.animations;\n    const children = instance.children;\n    removeTargetsFromAnimations(targetsArray, animations);\n    for (let c = children.length; c--;) {\n      const child = children[c];\n      const childAnimations = child.animations;\n      removeTargetsFromAnimations(targetsArray, childAnimations);\n      if (!childAnimations.length && !child.children.length) children.splice(c, 1);\n    }\n    if (!animations.length && !children.length) instance.pause();\n  }\n}\n\n// Stagger helpers\n\nfunction stagger(val, params = {}) {\n  const direction = params.direction || 'normal';\n  const easing = params.easing ? parseEasings(params.easing) : null;\n  const grid = params.grid;\n  const axis = params.axis;\n  let fromIndex = params.from || 0;\n  const fromFirst = fromIndex === 'first';\n  const fromCenter = fromIndex === 'center';\n  const fromLast = fromIndex === 'last';\n  const isRange = is.arr(val);\n  const val1 = isRange ? parseFloat(val[0]) : parseFloat(val);\n  const val2 = isRange ? parseFloat(val[1]) : 0;\n  const unit = getUnit(isRange ? val[1] : val) || 0;\n  const start = params.start || 0 + (isRange ? val1 : 0);\n  let values = [];\n  let maxValue = 0;\n  return (el, i, t) => {\n    if (fromFirst) fromIndex = 0;\n    if (fromCenter) fromIndex = (t - 1) / 2;\n    if (fromLast) fromIndex = t - 1;\n    if (!values.length) {\n      for (let index = 0; index < t; index++) {\n        if (!grid) {\n          values.push(Math.abs(fromIndex - index));\n        } else {\n          const fromX = !fromCenter ? fromIndex % grid[0] : (grid[0] - 1) / 2;\n          const fromY = !fromCenter ? Math.floor(fromIndex / grid[0]) : (grid[1] - 1) / 2;\n          const toX = index % grid[0];\n          const toY = Math.floor(index / grid[0]);\n          const distanceX = fromX - toX;\n          const distanceY = fromY - toY;\n          let value = Math.sqrt(distanceX * distanceX + distanceY * distanceY);\n          if (axis === 'x') value = -distanceX;\n          if (axis === 'y') value = -distanceY;\n          values.push(value);\n        }\n        maxValue = Math.max(...values);\n      }\n      if (easing) values = values.map(val => easing(val / maxValue) * maxValue);\n      if (direction === 'reverse') values = values.map(val => axis ? (val < 0) ? val * -1 : -val : Math.abs(maxValue - val));\n    }\n    const spacing = isRange ? (val2 - val1) / maxValue : val1;\n    return start + (spacing * (Math.round(values[i] * 100) / 100)) + unit;\n  }\n}\n\n// Timeline\n\nfunction timeline(params = {}) {\n  let tl = anime(params);\n  tl.duration = 0;\n  tl.add = function (instanceParams, timelineOffset) {\n    const tlIndex = activeInstances.indexOf(tl);\n    const children = tl.children;\n    if (tlIndex > -1) activeInstances.splice(tlIndex, 1);\n    function passThrough(ins) { ins.passThrough = true; };\n    for (let i = 0; i < children.length; i++) passThrough(children[i]);\n    let insParams = mergeObjects(instanceParams, replaceObjectProps(defaultTweenSettings, params));\n    insParams.targets = insParams.targets || params.targets;\n    const tlDuration = tl.duration;\n    insParams.autoplay = false;\n    insParams.direction = tl.direction;\n    insParams.timelineOffset = is.und(timelineOffset) ? tlDuration : getRelativeValue(timelineOffset, tlDuration);\n    passThrough(tl);\n    tl.seek(insParams.timelineOffset);\n    const ins = anime(insParams);\n    passThrough(ins);\n    const totalDuration = ins.duration + insParams.timelineOffset;\n    children.push(ins);\n    const timings = getInstanceTimings(children, params);\n    tl.delay = timings.delay;\n    tl.endDelay = timings.endDelay;\n    tl.duration = timings.duration;\n    tl.seek(0);\n    tl.reset();\n    if (tl.autoplay) tl.play();\n    return tl;\n  }\n  return tl;\n}\n\nanime.version = '3.2.0';\nanime.speed = 1;\nanime.running = activeInstances;\nanime.remove = removeTargets;\nanime.get = getOriginalTargetValue;\nanime.set = setTargetsValue;\nanime.convertPx = convertPxToUnit;\nanime.path = getPath;\nanime.setDashoffset = setDashoffset;\nanime.stagger = stagger;\nanime.timeline = timeline;\nanime.easing = parseEasings;\nanime.penner = penner;\nanime.random = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;\n\nexport default anime;","export const PALETTES = {\n  // PAC-MAN\n  1: [\n    '#999106',\n    '#635e09',\n    '#000000',\n    '#e4e4ef'\n  ],\n  // INKY\n  2: [\n    '#034f82',\n    '#5605a8',\n    '#878787',\n    '#e4e4ef'\n  ],\n  // PINKY\n  3: [\n    '#ed34ac',\n    '#5605a8',\n    '#878787',\n    '#e4e4ef'\n  ],\n  // BLINKY\n  4: [\n    '#bf0a0a',\n    '#5605a8',\n    '#878787',\n    '#e4e4ef'\n  ]\n}","import React, { useRef, useState, Suspense, forwardRef, useEffect } from 'react'\nimport { THREE } from 'expo-three';\nimport { useFrame } from 'react-three-fiber'\nimport { Html, useAspect } from 'drei'\nimport { useCircle } from '../../systems/Physics/hooks'\nimport { useEvents } from '../../systems/World/hooks'\nimport { CHARACTER_EVENTS } from '../../systems/World/Events'\nimport Ufo from '../UfoModels/UfoModel1'\nimport Ufo2 from '../UfoModels/UfoModel2'\nimport Ufo3 from '../UfoModels/UfoModel3'\nimport Ufo4 from '../UfoModels/UfoModel4'\nimport anime from '../../helpers/anime';\nimport emoteAlert from '../../../assets/emotes/emote_alert.png'\nimport emoteSwirl from '../../../assets/emotes/emote_swirl.png'\nimport { PALETTES } from '../../constants/gameOptions'\n\n/* PINK AND BLUE\n'#022f4d',\n'#660f1e',\n'#4a4848',\n'#e4e4ef'\n*/\n\nfunction SmokeInstances({ originMeshRef, color, seed = 0.3 }) {\n  const [sphereRefs] = useState(() => [])\n  const range = center => Math.random() * ((center + 0.4) - (center - 0.3)) + (center - 0.3)\n  const rangeMinMax = (min, max) => Math.random() * (max - min) + min\n  // const range = center => center - 0.35\n  const initialPositions = [\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 1), range(originMeshRef.current.position.z)],\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 2), range(originMeshRef.current.position.z)],\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 3), range(originMeshRef.current.position.z)],\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 4), range(originMeshRef.current.position.z)],\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 5), range(originMeshRef.current.position.z)],\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 6), range(originMeshRef.current.position.z)],\n  ]\n  const INCREMENT = 0.02\n  // smaller spheres movement\n  useFrame(() => {\n    // animate each sphere in the array\n    sphereRefs.forEach((el, idx) => {\n      el.position.y += INCREMENT\n      \n      if (el.position.y > originMeshRef.current.position.y + INCREMENT && el.position.y < originMeshRef.current.position.y + INCREMENT * 2) {\n        el.material.opacity = 1\n        // updates position\n        el.position.x = range(originMeshRef.current.position.x - 0.2)\n        el.position.z = range(originMeshRef.current.position.z - 0.2)\n      }\n\n      el.material.opacity -= 0.02\n      if (el.position.y > 1.5) {\n        el.material.opacity = 0\n        el.position.y = originMeshRef.current.position.y - 0.3 * idx\n        el.position.x = originMeshRef.current.position.x\n        el.position.z = originMeshRef.current.position.z\n      }\n    })\n  })\n  return (\n    <>\n      {initialPositions.map((pos, i) => (\n        <mesh\n          position={[pos[0], pos[1], pos[2]]}\n          key={i}\n          ref={(ref) => (sphereRefs[i] = ref)}\n        >\n          {/* <boxBufferGeometry args={[0.2, 0.2, 0.2]}/> */}\n          <sphereBufferGeometry args={[rangeMinMax(0.05, 0.2)]} />\n          <meshBasicMaterial color={color} opacity={0} transparent />\n        </mesh>\n      ))}\n    </>\n  )\n}\nconst Model = forwardRef((props, ref) => {\n  const [isFreezed, setFreezed] = useState(false)\n  const [emote, setEmote] = useState()\n  const [powerMaterial] = useState(new THREE.MeshNormalMaterial({ transparent: true, opacity: 0, wireframe: false, side: THREE.BackSide }))\n  const emoteTimerId = useRef()\n  const powerRef = useRef()\n  const ufoRef = useRef()\n  let baseRef = ref\n  useEvents(CHARACTER_EVENTS.GETS_FREEZER, uuid => setFreezed(uuid === baseRef.current.uuid))\n  useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_GROW, uuid => {\n    if (uuid === baseRef.current.uuid) {\n      const targetObj = { scale: 1 }\n      anime({\n        easing: 'linear',\n        duration: 250,\n        scale: 1.5,\n        targets: targetObj,\n        update: function () {\n          baseRef.current.scale.set(targetObj.scale, targetObj.scale, targetObj.scale)\n        }\n      })\n    }\n  })\n  const growOverchargeSphere = uuid => {\n    if (uuid === baseRef.current.uuid) {\n      powerRef.current.visible = true\n      anime({\n        easing: 'linear',\n        duration: 250,\n        opacity: 0.5,\n        targets: powerMaterial,\n      })\n    }\n  }\n  const shrinkOverchargeSphere = uuid => {\n    if (uuid === baseRef.current.uuid) {\n      anime({\n        easing: 'linear',\n        duration: 250,\n        opacity: 0,\n        targets: powerMaterial,\n        complete: function () {\n          powerRef.current.visible = false\n        }\n      })\n    }\n  }\n  useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_COIL, growOverchargeSphere)\n  useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_FREEZER, growOverchargeSphere)\n  useEvents(CHARACTER_EVENTS.DISCHARGE, shrinkOverchargeSphere)\n  \n  if (!props.userData.detached) {\n    [baseRef] = useCircle({}, ref)\n  } else {\n    console.log('DETACHED')\n  }\n  useEvents(CHARACTER_EVENTS.EXTERNAL_SPIN_CHANGE, uuid => {\n    if (uuid === baseRef.current.uuid) {\n      setEmote(emoteSwirl)\n    }\n  })\n\n  useEffect(() => {\n    if (emote) {\n      clearTimeout(emoteTimerId.current)\n      emoteTimerId.current = setTimeout(() => {\n        setEmote()\n      }, 1000);\n    }\n  }, [emote])\n\n  const indicatorGeometry = new THREE.Geometry();\n  const v1 = new THREE.Vector3(-0.25, 0, 0);\n  const v2 = new THREE.Vector3(0, -0.25, 0);\n  const v3 = new THREE.Vector3(0, 0.25, 0);\n\n  indicatorGeometry.vertices.push(v1);\n  indicatorGeometry.vertices.push(v2);\n  indicatorGeometry.vertices.push(v3);\n\n  indicatorGeometry.faces.push(new THREE.Face3(0, 1, 2));\n  indicatorGeometry.computeFaceNormals();\n\n  \n  useEffect(() => {\n    if (isFreezed) {\n      const offColorMaterial = new THREE.MeshBasicMaterial({ color: '#666666' })\n      const materials = ufoRef.current\n      // group\n      .children[0]\n      // mesh\n      .children[0]\n      .material\n      materials.forEach((material, i) => material.color = new THREE.Color(i % 2 === 0 ? 0x666666 : 0x999999))\n      console.log(materials)\n    }\n  }, [isFreezed])\n\n  let UfoModel\n  let indicatorOffset = [0, 0, 0]\n  let indicatorColor\n  switch (props.model) {\n    case 1:\n    default:\n      UfoModel = Ufo\n      indicatorOffset = [0.25, 0.25, 0]\n      indicatorColor = 'black'\n      break\n    case 2:\n      UfoModel = Ufo2\n      indicatorOffset = [0.35, 0.35, 0]\n      indicatorColor = 'red'\n      break\n    case 3:\n      UfoModel = Ufo3\n      indicatorOffset = [0.25, 0.35, 0]\n      indicatorColor = 'blue'\n      break\n    case 4:\n      UfoModel = Ufo4\n      indicatorOffset = [0.25, 0.35, 0]\n      indicatorColor = 'white'\n      break\n  }\n\n  const indicatorMaterial = new THREE.MeshBasicMaterial({ color: indicatorColor });\n  return (\n    <Suspense fallback={null}>\n      <>\n        {baseRef.current && !isFreezed && (\n          <SmokeInstances\n            originMeshRef={baseRef}\n            color={PALETTES[props.model || 1][0]}\n            seed={Math.random() * (0.3 - 0.01) + 0.01} />\n        )}\n        <group\n          ref={baseRef}\n          {...props}\n          dispose={null}\n        >\n          <Html>\n            {\n              emote && (\n                <div style={{ backgroundColor: 'transparent', marginTop: -38*1.5, marginLeft: -32/2}}>\n                  <img src={emote} />\n                </div>\n              )\n            }\n          </Html>\n          <mesh\n            ref={powerRef}\n            visible={false}\n            material={powerMaterial}\n          >\n            <sphereBufferGeometry args={[0.7, 10, 10]} />\n          </mesh>\n          {/* <mesh material={materials.snowRoad} geometry={nodes['Mesh enemy_ufoPurple_0'].geometry} />\n          <mesh material={materials.purple} geometry={nodes['Mesh enemy_ufoPurple_1'].geometry} />\n          <mesh castShadow material={colorMaterial} geometry={nodes['Mesh enemy_ufoPurple_2'].geometry} />\n          <mesh material={materials.glass} geometry={nodes['Mesh enemy_ufoPurple_3'].geometry} /> */}\n          <UfoModel\n            ref={ufoRef}\n            colorPalette={PALETTES[props.model || 1]}\n            // position={[0, 0, 0]}\n          />\n          <mesh\n            visible={!isFreezed}\n            material={indicatorMaterial}\n            rotation={[-THREE.Math.degToRad(90), -THREE.Math.degToRad(0), -THREE.Math.degToRad(180)]}\n            position={indicatorOffset}\n            geometry={indicatorGeometry}\n          />\n        </group>\n      </>\n    </Suspense>\n  )\n})\n\nexport default Model\n","import { useState } from 'react'\nimport { useFrame } from 'react-three-fiber'\nimport { isOutOfArena } from '../components/Arena2/arenaHelper'\n\nfunction useOutOfTheBox (elementRef) {\n  const [isOut, setIsOut] = useState(false)\n  useFrame(function() {\n    // check off platform\n    const { freeze } = elementRef.current?.userData || {}\n    if (elementRef.current && elementRef.current?.position && !freeze) {\n      if (isOutOfArena(elementRef)) {\n        setIsOut(true)\n      } else {\n        setIsOut(false)\n      }\n    }\n  })\n  return isOut\n}\n\nexport default useOutOfTheBox","export const isOutOfArena = ref => {\n  const outFromLeft = ref.current.position.x > 7.5\n  const outFromRight = ref.current.position.x < -7.5\n  const outFromTop = ref.current.position.z < -7.5\n  const outFromBottom = ref.current.position.z > 7.5\n  return outFromLeft || outFromRight || outFromTop || outFromBottom\n}\n","import anime from './anime'\n\nfunction animateFallUp(elementRef, onComplete) {\n  // animate destroy in threejs\n  const transformation = {\n    positionY: elementRef.current.position.y\n  };\n  anime(\n    {\n      easing: 'easeInBack',\n      duration: 1024,\n      positionY: 10,\n      targets: transformation,\n      update: function () {\n        elementRef.current.position.y = transformation.positionY;\n      },\n      complete: onComplete,\n    }\n  )\n}\n\nexport default animateFallUp\n","function respawnMe(elementRef, api) {\n  // delay for weird UI behaviour\n  setTimeout(() => {\n    api.restart(elementRef.current.uuid, elementRef.current.userData.origin)\n    elementRef.current.userData = { ...elementRef.current.userData, freeze: false }\n    elementRef.current.position.y = 0;\n  }, 100);\n}\nexport default respawnMe\n","import { useRef, useLayoutEffect, useEffect } from 'react'\nimport { CollisionsManager } from '../systems/World/EventsManager'\n\nfunction useCollision(callback: Function, uuid: string): null {\n  const subscribe = CollisionsManager.onCollide.bind(CollisionsManager)\n  // Update ref\n  const ref = useRef(callback)\n  useLayoutEffect(() => void (ref.current = callback), [callback])\n  // Subscribe/unsub\n  useEffect(() => {\n    const unsubscribe = subscribe(callback, uuid)\n    return () => unsubscribe()\n  }, [uuid, subscribe])\n  return null\n}\n\nexport default useCollision","import React, { useState, useEffect, useRef, forwardRef, useMemo, useCallback } from 'react'\nimport { useFrame } from 'react-three-fiber'\nimport { THREE } from 'expo-three'\nimport { useApi } from '../../systems/Physics/hooks'\nimport { useEvents } from '../../systems/World/hooks'\nimport UfoShip from '../UfoShip'\nimport useOutOfTheBox from '../../hooks/useOutOfTheBox'\nimport animateFallUp from '../../helpers/animateFallUp'\nimport respawnMe from '../../helpers/respawnMe'\nimport { CHARACTER_EVENTS, GAME_EVENTS } from '../../systems/World/Events'\nimport useCollision from '../../hooks/useCollision'\n\nconst useTurnsCounter = (callback, ref) => {\n  const flagSafeTurn = useRef(true);\n  const [turns, setTurns] = useState(0)\n  const [originalAngle, setOriginalAngle] = useState(0)\n  const [active, setActive] = useState()\n  useFrame(() => {\n    if (!ref.current || !active) return\n    if (~~ref.current.rotation.y === originalAngle) {\n      if (flagSafeTurn.current) {\n        setTurns(turns + 1)\n        flagSafeTurn.current = false\n      }\n    } else {\n      flagSafeTurn.current = true\n    }\n  })\n  useEffect(() => {\n    if (!ref.current || !active) return\n    setOriginalAngle(~~ref.current.rotation.y)\n  }, [ref.current])\n\n  useEffect(() => {\n    if(turns !== 0) {\n      callback(turns)\n    }\n  }, [turns])\n\n  useEvents(GAME_EVENTS.READY_ON, () => setActive(true))\n  useEvents(GAME_EVENTS.READY_OFF, () => setActive(false))\n  \n  // useTimeout(() => setTurns(1), 1000)\n  \n  return null\n}\n\nconst getAggressivenessByModel = model => model === 4 ? 0.8 : model === 3 ? 0.5 : model === 2 ? 0.3 : 0\nconst getWandernessByModel = model => model === 4 ? 0.9 : model === 3 ? 0.8 : model === 2 ? 0.7 : 0\nconst getReflexesByModel = model => model === 4 ? 1000 : model === 3 ? 2000 : model === 2 ? 3000 : 4000\nconst Enemy = forwardRef(({\n  userController,\n  enemies,\n  model,\n  spin,\n  ...props\n}, externalRef) => {\n  \n  const api = useApi()\n  // const [attack, setAttack] = useState(false);\n  const target = useRef()\n  const impulse = useRef(200)\n  const impulseRef = useRef()\n  const impulseTID = useRef()\n  const retargetTID = useRef()\n  const outOfRing = useOutOfTheBox(externalRef)\n  const triggerOutOfRing = useEvents(CHARACTER_EVENTS.OUT_OF_RING)\n  const triggerImpulseOn = useEvents(CHARACTER_EVENTS.IMPULSE_ON)\n  const triggerImpulseOff = useEvents(CHARACTER_EVENTS.IMPULSE_OFF)\n  useEvents(GAME_EVENTS.READY_ON, () => {\n    api.unfreeze(externalRef.current.uuid)\n    setTarget('attack')\n  })\n  useCollision(() => {\n    setTarget()\n  }, externalRef.current?.uuid)\n  useEffect(() => {\n    if (outOfRing) {\n      // setAttack(false)\n      api.outOfThisWorld(externalRef.current.uuid)\n      triggerOutOfRing(externalRef)\n      animateFallUp(externalRef, () => {\n        /* respawnMe(externalRef, api) */\n        api.destroy(externalRef.current.uuid)\n      })\n    }\n  }, [outOfRing])\n  // const externalRef = useRef(null)\n  const lookObject = new THREE.Object3D();\n\n  function applyImpuse() {\n    impulseRef.current = true\n    api.impulse(externalRef.current.uuid, true)\n    triggerImpulseOn({ uuid: externalRef.current.uuid, api })\n  }\n  function stopImpulse() {\n    impulseRef.current = false\n    api.impulse(externalRef.current.uuid, false)\n    triggerImpulseOff({ uuid: externalRef.current.uuid, api })\n  }\n  function setTarget(forceTo) {\n    const aggressiveness = getAggressivenessByModel(model)\n    // const vagueness = model === 4 ? 0.1 : model === 3 ? 0.3 : model === 2 ? 0.5 : 0.8\n    const wanderness = getWandernessByModel(model)\n    \n    if (Math.random() < aggressiveness || forceTo === 'attack') {\n      // attack\n      target.current = enemies[0].current\n    } else if (Math.random() < wanderness || forceTo === 'wander') {\n      // wander\n      const range = (min, max) => Math.random() * (max - min) + min\n      target.current = new THREE.Object3D()\n      const pos = new THREE.Vector3( Math.round(range(5, -5)), 0, Math.round(range(5, -5)))\n      target.current.position.copy(pos)\n    } else {\n      // wait\n    }\n\n    // refresh target after 3 secs\n    clearTimeout(retargetTID.current)\n    retargetTID.current = setTimeout(() => {\n      setTarget()\n    }, getReflexesByModel(model));\n  }\n\n  useFrame(() => {\n    if (target.current) {\n      const myself = externalRef.current\n      const targetObj = target.current\n      const impulseDuration = impulse.current\n      // update helper position\n      lookObject.position.copy(myself.position)\n      // make helper to look at enemy (usually a player)\n      lookObject.lookAt(targetObj.position)\n      // dunno why I need to subtract 90 deg to Y rotation after lookAt\n      lookObject.rotateY(-Math.PI / 2)\n\n      if (lookObject.quaternion.angleTo(myself.quaternion) < 0.1 && !impulseRef.current) {\n        applyImpuse()\n        clearTimeout(impulseTID.current)\n        impulseTID.current = setTimeout(stopImpulse, impulseDuration)\n      }\n    }\n    \n  })\n  \n  // how many times did a 360 spin\n  useTurnsCounter(turns => {\n    // counr?\n  }, externalRef)\n\n  let spinSpeed = 2\n  switch (model) {\n    case 1:\n    default:\n      spinSpeed = 2\n      break\n    case 2:\n      spinSpeed = 1.5\n      break\n    case 3:\n      spinSpeed = 2\n      break\n    case 4:\n      spinSpeed = 2.5\n      break\n  }\n  return useMemo(() =>\n    <UfoShip\n      ref={externalRef}\n      model={model}\n      {...props}\n      userData={{\n        origin: props.position,\n        rotate: true,\n        detached: false,\n        isEnemy: true,\n        freeze: true,\n        spinFactor: spin === 'ccw' ? -1 : 1,\n        spinSpeed,\n        model,\n      }} />, [])\n})\n\nexport default Enemy\n","import React, { useRef, useState, useEffect, Suspense, forwardRef, useMemo } from 'react'\nimport { useApi } from '../../systems/Physics/hooks'\nimport { useEvents } from '../../systems/World/hooks'\nimport UfoBase from '../UfoShip'\nimport useOutOfTheBox from '../../hooks/useOutOfTheBox'\nimport animateFallUp from '../../helpers/animateFallUp'\nimport respawnMe from '../../helpers/respawnMe'\nimport useTimeout from '../../hooks/useTimeout'\nimport { CHARACTER_EVENTS, GAME_EVENTS } from '../../systems/World/Events'\n\nconst Player = forwardRef((props, externalRef) => {\n  const api = useApi()\n  const { userController, ...moreProps } = props\n  const outOfRing = useOutOfTheBox(externalRef)\n  const triggerOutOfRing = useEvents(CHARACTER_EVENTS.OUT_OF_RING)\n  const triggerImpulseOn = useEvents(CHARACTER_EVENTS.IMPULSE_ON)\n  const triggerImpulseOff = useEvents(CHARACTER_EVENTS.IMPULSE_OFF)\n  useEvents(GAME_EVENTS.READY_ON, () => {api.unfreeze(externalRef.current.uuid)})\n  useEffect(() => {\n    if (outOfRing) {\n      api.outOfThisWorld(externalRef.current.uuid)\n      triggerOutOfRing(externalRef)\n      animateFallUp(externalRef, () => { /*respawnMe(externalRef, api)*/ })\n    }\n  }, [outOfRing])\n  useEffect(() => {\n    const unsubscribeControllerOn = userController.addEventListener('controller_on', () => {\n      api.impulse(externalRef.current.uuid, true)\n      triggerImpulseOn({ uuid: externalRef.current.uuid, api })\n\n    })\n    const unsubscribeControllerOff = userController.addEventListener('controller_off', () => {\n      api.impulse(externalRef.current.uuid, false)\n      triggerImpulseOff({ uuid: externalRef.current.uuid, api })\n    })\n    const unsubscribeControllerRestart = userController.addEventListener('controller_restart', () => {\n      api.restart(externalRef.current.uuid)\n    })\n    const unsubscribeControllerDoubleTap = userController.addEventListener('controller_doubleTap', () => {\n      api.revertSpin(externalRef.current.uuid)\n    })\n    return () => {\n      unsubscribeControllerOn()\n      unsubscribeControllerOff()\n      unsubscribeControllerRestart()\n      unsubscribeControllerDoubleTap()\n    }\n  }, [externalRef.current])\n  \n  return useMemo(() =>\n    <UfoBase\n      ref={externalRef}\n      {...moreProps}\n      userData={{\n        origin: moreProps.position,\n        density: 1,\n        isPlayer: true,\n        freeze: true,\n        spinFactor: 1,\n        spinSpeed: 2,\n        model: 1,\n      }}\n    />, []\n  )\n})\n\nexport default Player\n","import Box2D from 'box2dweb'\nconst b2Vec2 = Box2D.Common.Math.b2Vec2\nconst b2RayCastOutput = Box2D.Collision.b2RayCastOutput\nlet playerBody\nlet enemyBody\nlet hittable = false\nexport default function loop(refs) {\n  Object.keys(refs).forEach(r => {\n    const { object, body } = refs[r]\n    // handle position for development purpose\n    if (body && object) {\n      // if (object.userData.isPlayer && !playerBody) {\n      //   playerBody = body\n      //   const playerPos = playerBody.GetPosition()\n      //   playerPos.x = 0\n      //   playerPos.y = -4\n      //   playerBody.SetTransform({ position: playerPos, GetAngle: () => playerBody.GetAngle() })\n      // }\n      // if (object.userData.isEnemy && !enemyBody) {\n      //   enemyBody = body\n      //   const enemyPos = enemyBody.GetPosition()\n      //   enemyPos.x = -2\n      //   enemyPos.y = 0\n      //   enemyBody.SetTransform({ position: enemyPos, GetAngle: () => enemyBody.GetAngle() })\n      // }\n\n      const { impulse, rotate, spinSpeed = 2, originPosition, pickable, spinFactor } = body.GetUserData()\n      \n      let angle = body.GetAngle()\n      \n      const pos = body.GetPosition()\n      if (impulse) {\n        const power = 0.1// + body.GetLinearDamping() //+ body.GetFixtureList().GetDensity() * 0.1\n        const direction = new b2Vec2(power * Math.cos(angle * Math.PI / 180), power * Math.sin(angle * Math.PI / 180))\n\n        body.ApplyImpulse(direction, body.GetWorldCenter())\n      }\n      if (rotate) {\n        angle = angle + (spinSpeed * spinFactor)\n        if (angle > 360) {\n          angle -= 360\n        } else if (angle < -360) {\n          angle += 360\n        }\n        body.SetTransform({ position: body.GetPosition(), GetAngle: () => angle })\n      }\n      // Apply Box2d props to Three object\n      const newPos = { x: pos.x, y: object.position.y, z: pos.y };\n      object.position.copy(newPos)\n\n      object.rotation.y = (-angle * Math.PI / 180)\n    }\n  })\n}","import Box2D from 'box2dweb'\nimport { EventsManager } from './EventsManager'\nimport { CHARACTER_EVENTS } from './Events'\n\nconst b2Vec2 = Box2D.Common.Math.b2Vec2\nconst b2RayCastOutput = Box2D.Collision.b2RayCastOutput\n\nconst fixtureIsCharacter = fix => fix.GetBody().GetUserData().isPlayer || fix.GetBody().GetUserData().isEnemy\nconst isDirectHit = (fixA, fixB) => {\n  let rayCastOutput = new b2RayCastOutput\n  const bodyA = fixA.GetBody()\n  const rayLength = 1\n  const p1 = bodyA.GetPosition()\n  const bodyAPosX = Math.cos(bodyA.GetAngle() / 180 * Math.PI)\n  const bodyAPosY = Math.sin(bodyA.GetAngle() / 180 * Math.PI)\n  const dest = new b2Vec2(\n    rayLength * bodyAPosX,\n    rayLength * bodyAPosY\n  )\n  const p2 = new b2Vec2(p1.x, p1.y)\n  p2.Add(dest)\n  \n  const rayInput = {\n    p1,\n    p2,\n    maxFraction: 1,\n  }\n\n  return fixB.RayCast(rayCastOutput, rayInput)\n}\nconst isOvercharged = fix => fix.GetBody().GetUserData().coil || fix.GetBody().GetUserData().freezer\n\nconst applyExtraImpulse = (fixA, fixB) => {\n  const bodyA = fixA.GetBody()\n  const bodyB = fixB.GetBody()\n  // direction based on angle\n  const bodyAPosX = Math.cos(bodyA.GetAngle() / 180 * Math.PI)\n  const bodyAPosY = Math.sin(bodyA.GetAngle() / 180 * Math.PI)\n\n  // if both are normal, multiply hit by 5.\n  let extraPower = 5\n  // if hit-giver is Hulk, multiply hit power by 10.\n  extraPower = bodyA.GetUserData().hulk ? 10 : extraPower\n  // if hit-receiver is Hulk, keep hit power.\n  extraPower = bodyB.GetUserData().hulk ? 0 : extraPower\n  // if hit-giver is dead (freezed), keep hit power\n  extraPower = !bodyA.GetUserData().impulse ? 0 : extraPower\n  // x times of \n  const impulseVector = new b2Vec2(\n    extraPower * bodyAPosX,\n    extraPower * bodyAPosY\n  )\n  \n  bodyB.ApplyImpulse(impulseVector, bodyB.GetWorldCenter())\n}\n\nconst applyOverchargeCoil = (fixA, fixB) => {\n  const bodyA = fixA.GetBody()\n  const bodyB = fixB.GetBody()\n  const posA = bodyA.GetPosition()\n  const posB = bodyB.GetPosition().Copy()\n\n  // distance between two objs position\n  posB.Subtract(posA)\n  // normalize to 0,0\n  posB.Normalize()\n  // x times of force of the kickback\n  const extraPower = 15\n\n  const impulseVector = new b2Vec2(\n    extraPower * posB.x,\n    extraPower * posB.y\n  )\n\n  bodyB.ApplyImpulse(impulseVector, bodyB.GetWorldCenter())\n}\n\nconst overchargeReaction = (fixA, fixB) => {\n  const bodyA = fixA.GetBody()\n  const bodyB = fixB.GetBody()\n  if (bodyA.GetUserData().coil) {\n    bodyA.SetUserData({ ...bodyA.GetUserData(), coil: false})\n    EventsManager.dispatch(CHARACTER_EVENTS.GETS_COIL, bodyB.GetUserData().uuid)\n    EventsManager.dispatch(CHARACTER_EVENTS.DISCHARGE, bodyA.GetUserData().uuid)\n    applyOverchargeCoil(fixA, fixB)\n  }\n  if (bodyB.GetUserData().coil) {\n    bodyB.SetUserData({ ...bodyB.GetUserData(), coil: false})\n    EventsManager.dispatch(CHARACTER_EVENTS.GETS_COIL, bodyA.GetUserData().uuid)\n    EventsManager.dispatch(CHARACTER_EVENTS.DISCHARGE, bodyB.GetUserData().uuid)\n    applyOverchargeCoil(fixB, fixA)\n  }\n\n  if (bodyB.GetUserData().freezer) {\n    bodyB.SetUserData({ ...bodyB.GetUserData(), freezer: false})\n    EventsManager.dispatch(CHARACTER_EVENTS.DISCHARGE, bodyB.GetUserData().uuid)\n    EventsManager.dispatch(CHARACTER_EVENTS.GETS_FREEZER, bodyA.GetUserData().uuid)\n    bodyA.SetUserData({ ...bodyA.GetUserData(), rotate: false, freeze: true, impulse: false })\n  }\n  if (bodyA.GetUserData().freezer) {\n    bodyA.SetUserData({ ...bodyA.GetUserData(), freezer: false})\n    EventsManager.dispatch(CHARACTER_EVENTS.DISCHARGE, bodyA.GetUserData().uuid)\n    EventsManager.dispatch(CHARACTER_EVENTS.GETS_FREEZER, bodyB.GetUserData().uuid)\n    bodyB.SetUserData({ ...bodyB.GetUserData(), rotate: false, freeze: true, impulse: false })\n  }\n}\n\nconst setHitBy = (fixA, fixB, directHitAtoB, directHitBtoA) => {\n  const bodyA = fixA.GetBody()\n  const bodyB = fixB.GetBody()\n  const bodyAData = bodyA.GetUserData()\n  const bodyBData = bodyB.GetUserData()\n  const time = new Date()\n  bodyA.SetUserData({ ...bodyAData, hitBy: bodyBData.uuid, hitByTime: time, hitByDirect: directHitBtoA })\n  bodyB.SetUserData({ ...bodyBData, hitBy: bodyAData.uuid, hitByTime: time, hitByDirect: directHitAtoB })\n}\n\nexport default function HitPhysics (b2Contact) {\n  const fixA = b2Contact.GetFixtureA()\n  const fixB = b2Contact.GetFixtureB()\n  const isTwoCharactersHit = fixtureIsCharacter(fixA) && fixtureIsCharacter(fixB)\n  if (isTwoCharactersHit) {\n    const isDirectHitAtoB = isDirectHit(fixA, fixB)\n    const isDirectHitBtoA = isDirectHit(fixB, fixA)\n    setHitBy(fixA, fixB, isDirectHitAtoB, isDirectHitBtoA)\n    if (isOvercharged(fixA) || isOvercharged(fixB)) {\n      overchargeReaction(fixA, fixB)\n    } else {\n      // only if no ship is overcharged\n      if (isDirectHitAtoB) {\n        applyExtraImpulse(fixA, fixB)\n      }\n      if (isDirectHitBtoA) {\n        applyExtraImpulse(fixB, fixA)\n      }\n    }\n  }\n}","import React, { useState, useEffect, useRef, useMemo } from 'react'\nimport Box2D from 'box2dweb'\nimport { THREE } from 'expo-three';\nimport context from './context'\nimport { useFrame } from 'react-three-fiber'\nimport { CollisionsManager } from '../World/EventsManager'\nimport CharactersLoop from '../World/CharactersLoop'\nimport HitPhysics from '../World/HitPhysics'\n\nconst b2World = Box2D.Dynamics.b2World\nconst b2Vec2 = Box2D.Common.Math.b2Vec2\nconst b2BodyDef = Box2D.Dynamics.b2BodyDef;\nconst b2Body = Box2D.Dynamics.b2Body;\nconst b2FixtureDef = Box2D.Dynamics.b2FixtureDef;\nconst b2ContactListener = Box2D.Dynamics.b2ContactListener;\n\nfunction emptyCallback () { return false }\nexport default function Provider({\n  children,\n  onReady\n}) {\n  const [world, setWorld] = useState()\n  const [clock] = useState(new THREE.Clock())\n  const refs = {}\n  const bodies = []\n  let destroyQueue = []\n  const actions = {\n    impulse: () => {\n  \n    }\n  }\n  useFrame(() => {\n    if (world && !world.IsLocked()) {\n      // if (!world.IsLocked()) {\n        // }\n      CharactersLoop(refs)\n      const timestep =  clock.getDelta()// 1 / 60\n      world.Step(1/60, 10, 8)\n      while(destroyQueue.length) {\n        world.DestroyBody(destroyQueue.pop())\n      }\n    }\n  })\n  useEffect(() => {\n    const gravity = new b2Vec2(0, 0)\n    var world = new b2World(gravity, true)\n    \n    const contactListener = new b2ContactListener;\n    contactListener.BeginContact = CollisionsManager.dispatchOnBeginContact.bind(CollisionsManager)\n    contactListener.EndContact = CollisionsManager.dispatchOnEndContact.bind(CollisionsManager)\n    world.SetContactListener(contactListener)\n    world.SetContinuousPhysics(true)\n\n    CollisionsManager.onEndContact(HitPhysics)\n\n    setWorld(world)\n    return () => {\n      // destroy world ??\n    }\n  }, [])\n  // const api = useMemo(() => ({ bodies, world, refs, actions }), [bodies, world, refs, actions])\n  const api = { bodies, world, refs, actions, destroyQueue }\n  if (onReady) {\n    onReady(api)\n  }\n  return <context.Provider value={api}>{children}</context.Provider>\n}","import React, { Suspense, createContext, lazy } from 'react'\nimport Provider from './Provider'\n\n// const Provider = typeof window === 'undefined' ? () => null : lazy(() => import('./Provider'))\n\nfunction Physics(props) {\n  return (\n    // <Suspense fallback={null}>\n      <Provider {...props} />\n    // </Suspense>\n  )\n}\n\nexport { Physics }\n","import { useState, useEffect } from 'react'\n// Hook\nfunction useKeyPress(targetKey) {\n  // State for keeping track of whether key is pressed\n  const [keyPressed, setKeyPressed] = useState(false);\n\n  // If pressed key is our target key then set to true\n  function downHandler({ key }) {\n    if (key === targetKey) {\n      setKeyPressed(true);\n    }\n  }\n\n  // If released key is our target key then set to false\n  const upHandler = ({ key }) => {\n    if (key === targetKey) {\n      setKeyPressed(false);\n    }\n  };\n\n  // Add event listeners\n  useEffect(() => {\n    window.addEventListener('keydown', downHandler);\n    window.addEventListener('keyup', upHandler);\n    // Remove event listeners on cleanup\n    return () => {\n      window.removeEventListener('keydown', downHandler);\n      window.removeEventListener('keyup', upHandler);\n    };\n  }, []); // Empty array ensures that effect is only run on mount and unmount\n\n  return keyPressed;\n}\n\nexport default useKeyPress","import React, { useState, useEffect } from 'react'\nimport { View, Dimensions, TouchableWithoutFeedback } from 'react-native'\nimport useKeyPress from '../../hooks/useKeyPress'\n\nconst { height, width } = Dimensions.get('screen');\nconst KEY_THROTTLE_BY_PLAYER_INDEX = {\n  0: 'z',\n  1: 'm',\n}\nconst SCREEN_POS_BY_PLAYER_INDEX = {\n  // player 1 lower right\n  0: {\n    posX: width - 100,\n    posY: height - 100,\n    width,\n    height,\n  },\n  // player 2 lower left\n  1: {\n    posX: 0,\n    posY: height - 100,\n    width: 100,\n    height,\n    color: '#00f',\n  }\n}\nconst COLORS_BY_PLAYER_INDEX = {\n  0: {\n    player: '#AFC97E',\n    controller: '#AFC97E',\n  },\n  1: {\n    player: '#306BAC',\n    controller: '#306BAC',\n  }\n}\nconst usePlayers = (refs = []) => {\n  const playersConfig = refs.map((p, idx) => {\n    return (\n      {\n        name: `player${idx + 1}`,\n        ...SCREEN_POS_BY_PLAYER_INDEX[idx],\n        keyboardThrottle: KEY_THROTTLE_BY_PLAYER_INDEX[idx],\n        isThrottling: false,\n        hit: false,\n        controller: p,\n        color: COLORS_BY_PLAYER_INDEX[idx],\n      }\n    )\n  })\n  \n  return playersConfig\n}\n\nconst useHitArea = (hitAreaPlayers = []) => {\n  const checkTouchOnPlayerAreas = evt => {\n    // console.log(typeof evt.nativeEvent.touches === 'TouchList')\n    hitAreaPlayers.forEach(ha => ha.hit = false)\n    evt.nativeEvent.touches.forEach(t => {\n      hitAreaPlayers.forEach(ha => {\n        if (\n          (t.pageX > ha.posX &&\n          t.pageY > ha.posY &&\n          t.pageX < ha.posX + ha.width &&\n          t.pageY < ha.posY + ha.height)\n          || ha.isThrottling\n        ) {\n          // const touchTime = global.nativePerformanceNow()\n          const touchTime = window.performance.now()\n          const diff = touchTime - ha.lastTouchTime;\n          if (diff < 150) {\n            ha.doubleTap = true\n          } else {\n            ha.doubleTap = false\n          }\n          ha.hit = true\n          ha.lastTouchTime = touchTime;\n        }\n      })\n    })\n\n    hitAreaPlayers.forEach(ha => {\n      if (ha.hit) {\n        // console.log('GO!', ha.name)\n      }\n      ha.controller.dispatch(`controller_${ha.hit ? 'on' : 'off'}`)\n      if (ha.doubleTap) {\n        ha.doubleTap = false\n        // ha.controller.dispatch('controller_doubleTap')\n      }\n    })\n  }\n  // console.log('HIT', hitAreaPlayers[0].name, hitAreaPlayers[0].hit)\n  // console.log('HIT', hitAreaPlayers[1].name, hitAreaPlayers[1].hit)\n  // console.log('=====')\n  return {\n    handleTouchStart: checkTouchOnPlayerAreas,\n    handleTouchEnd: checkTouchOnPlayerAreas,\n  }\n}\n\nconst Controllers = ({ forPlayers = [], noUI}) => {\n  // console.log(forPlayers)\n  // gets players config\n  const players = usePlayers(forPlayers)\n\n  useEffect(() => {\n    // setTimeout(() => {\n    //   players.find(p => p.name === 'player1').controller.dispatch('controller_restart')\n    // }, 5000);\n    // external API\n    window.SS_controller_p2_throttle = state => {\n      players[1].isThrottling = state\n      handleTouchStart({ nativeEvent: { touches: [{}] }})\n    }\n    // window.SS_controller_p1_throttle = state => {\n    //   players[0].isThrottling = state\n    //   handleTouchStart({ nativeEvent: { touches: [{}] }})\n    // }\n  }, [])\n  \n  // makes player configs to handle events\n  const { handleTouchStart, handleTouchEnd } = useHitArea(players)\n  // console.log(players[0].keyboardThrottle)\n  const P1ThrottleKeyPressed = useKeyPress(players[0].keyboardThrottle)\n  useEffect(() => {\n    players[0].isThrottling = P1ThrottleKeyPressed\n    // console.log('throttling?', players[0].isThrottling)\n    handleTouchStart({ nativeEvent: { touches: [{}] }})\n  }, [P1ThrottleKeyPressed])\n\n  const P2ThrottleKeyPressed = useKeyPress(players[1].keyboardThrottle)\n  useEffect(() => {\n    players[1].isThrottling = P2ThrottleKeyPressed\n    // console.log('throttling?', players[1].isThrottling)\n    handleTouchStart({ nativeEvent: { touches: [{}] } })\n  }, [P2ThrottleKeyPressed])\n\n\n  return (\n    <React.Fragment>\n      {\n        players[0] && !noUI ? \n        <View\n          onTouchStart={handleTouchStart}\n          onTouchEnd={handleTouchEnd}\n            style={{ position: 'absolute', width: 100, height: 100, bottom: 0, right: 0, backgroundColor: `${players[0].color.controller}aa` }}\n        />:null\n      }\n      {\n        players[1] && !noUI? \n        <View\n          onTouchStart={handleTouchStart}\n          onTouchEnd={handleTouchEnd}\n            style={{ position: 'absolute', width: 100, height: 100, bottom: 0, left: 0, backgroundColor: `${players[1].color.controller}aa` }}\n        />:null\n      }\n    </React.Fragment>\n  )\n}\n\nexport default Controllers","import React, { useEffect, useState, forwardRef, useRef } from 'react';\nimport { TextureLoader, FileLoader, THREE } from 'expo-three'\nimport { Text } from 'drei'\nimport { Asset } from 'expo-asset';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\nimport { useThree } from 'react-three-fiber';\nimport cubeObj from '../../../assets/cube.obj'\nimport cubeMtl from '../../../assets/cube.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\nconst loaderTxt = new TextureLoader();\n\nconst normalMapImage = loaderTxt.load(require('../../../assets/textures/cube_rock_A_mat_normal.png'))\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { texture, tint, name = '', ...moreProps } = props\n  const mapImage = loaderTxt.load(texture)\n  \n  const loadObject = async () => {\n    \n    const mtl = loaderMtl.parse(cubeMtl)\n    mtl.preload();\n    // mtl.materials.cube_rock_A_mat.map = mapImage\n    // mtl.materials.cube_rock_A_mat.normalMap = normalMapImage\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(cubeObj)\n    // replace MeshStandardMaterial by MeshLambertMaterial sice the last one\n    // is more performant and includes shadows.\n    const rockMaterial = new THREE.MeshLambertMaterial({\n      color: tint,\n      transparent: false,\n      opacity: 1,\n      wireframe: false,\n      side: THREE.FrontSide,\n      map: mapImage,\n      normalMap: normalMapImage,\n    })\n    // obj.children[0].material.map = mapImage\n    // obj.children[0].material.normalMap = normalMapImage\n    obj.children[0].material = rockMaterial\n    obj.children[0].receiveShadow = true\n    obj.children[0].castShadow = true\n    obj.children[0].side = THREE.FrontSide\n    // console.log(obj)\n    \n    setGeometry(obj)\n    // scene.add(obj)\n  }\n  \n  useEffect(loadObject,[])\n  // console.log(geometry ? 'LOADED' : 'NOT YET')\n  return (\n    <>\n      <group\n        position={[0, -1.9, 7.9]}\n      >\n        <Text\n          font={require('../../../assets/fonts/Sandoval.ttf')}\n          fontSize={1}\n          anchorX=\"center\" // default\n          anchorY=\"middle\" // default\n          material={new THREE.MeshBasicMaterial({color: tint, opacity: 0.5, transparent: true })}\n        >\n          {name.toUpperCase()}\n        </Text>\n      </group>\n      <group\n        ref={fwdRef}\n        {...moreProps}\n        dispose={null}\n      >\n        {geometry &&\n          <primitive object={geometry} />\n        }\n      </group>\n    </>\n  )\n})","/*\nauto-generated by: https://github.com/react-spring/gltfjsx\n*/\n\nimport { THREE } from 'expo-three'\nimport React, { useRef, forwardRef, useLayoutEffect, useEffect, Suspense, useState } from 'react'\nimport { useFrame } from 'react-three-fiber'\nimport { useApi, useCircle } from '../../systems/Physics/hooks'\nimport useCollision from '../../hooks/useCollision'\nimport { useEvents } from '../../systems/World/hooks'\nimport { CHARACTER_EVENTS } from '../../systems/World/Events'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/crystals/detail_crystal.obj'\nimport modelMtl from '../../../assets/crystals/detail_crystal.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\nconst COLORS_BY_TYPE = {\n  grow: 0x006600,\n  coil: 0x2a4db5,\n  freezer: 0x99ccff,\n}\n\nfunction hide(ref) {\n  if (ref.current.visible) {\n    ref.current.visible = false\n  }\n}\nfunction show(ref) {\n  if (!ref.current.visible) {\n    ref.current.visible = true\n  }\n}\n\nconst Model = props => {\n  const { type, timeToAppear, ...passProps } = props\n  const [step, setStep] = useState('HIDDEN')\n  const ref = useRef()\n  const circleRef = useRef()\n  const [geometry, setGeometry] = useState()\n  const [baseRef] = useCircle({}, ref)\n  const api = useApi()\n  const triggerOnPickCoil = useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_COIL)\n  const triggerOnPickFreezer = useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_FREEZER)\n  const triggerOnPickGrow = useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_GROW)\n  const triggerOnOvercharge = useEvents(CHARACTER_EVENTS.OVERCHARGE)\n  \n  useCollision(collidedFixture => {\n    if (step === 'AVAILABLE') {\n      setStep('PICKED')\n      const uuid = collidedFixture.GetBody().GetUserData().uuid\n      if (type === 'grow') {\n        api.grow(uuid)\n        triggerOnPickGrow(uuid)\n      }\n      if (type === 'coil') {\n        api.overchargePower(uuid)\n        triggerOnPickCoil(uuid)\n        triggerOnOvercharge(uuid)\n      }\n      if (type === 'freezer') {\n        api.overchargeFreezer(uuid)\n        triggerOnPickFreezer(uuid)\n        triggerOnOvercharge(uuid)\n      }\n    }\n  }, baseRef.current?.uuid)\n  \n  // change pink by green\n  let colorMaterial = new THREE.MeshLambertMaterial({ color: COLORS_BY_TYPE[type] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material = colorMaterial\n\n    obj.children[0].castShadow = true\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  useEffect(() => {\n    setTimeout(() => {\n      setStep('APPROACHING')\n    }, timeToAppear);\n  },[])\n  \n  function animationLoop() {\n    switch (step) {\n      case 'HIDDEN':\n        hide(circleRef)\n        hide(baseRef)\n        break\n      case 'APPROACHING':\n        show(circleRef)\n        if (circleRef.current.scale.x > 0) {\n          circleRef.current.scale.x = circleRef.current.scale.y = circleRef.current.scale.z -= 0.005\n        } else {\n          setStep('AVAILABLE')\n        }\n        break\n      case 'AVAILABLE':\n        hide(circleRef)\n        show(baseRef)\n        break\n      case 'PICKED':\n        hide(baseRef)\n        break\n      default:\n        break\n    }\n  }\n  useFrame(() => {\n    if (circleRef.current) {\n      animationLoop()\n    }\n  })\n  \n  return (\n    <>\n      <group\n        ref={circleRef}\n        position={passProps.position}\n      >\n        <mesh\n          rotation={[-Math.PI/2, 0, 0]}\n          geometry={new THREE.RingGeometry(14.99, 15, 62)}\n          material={new THREE.LineBasicMaterial({ color: 0xffff00 })}\n        />\n      </group>\n      <group\n        ref={baseRef}\n        visible={false}\n        // position={[0, 0.21, 0]}\n        {...passProps}\n        dispose={null}\n        userData={{\n          radius: 0.25,\n          pickable: true,\n          originPosition: [0, 0.25, 0],\n        }}\n      >\n        {geometry &&\n          <primitive object={geometry} />\n        }\n        {/* <mesh\n          castShadow\n          material={colorMaterial}\n          geometry={nodes.detail_crystal.geometry}\n        /> */}\n      </group>\n    </>\n  )\n}\n\nexport default Model","import React, { forwardRef, useRef, useMemo, useState } from 'react'\nimport { THREE } from 'expo-three';\nimport { useBox } from '../../systems/Physics/hooks'\nimport useCollision from '../../hooks/useCollision'\nimport anime from '../../helpers/anime';\n\nexport default forwardRef(({\n  hx = 0.5,\n  hy = 3,\n  rotate = 0,\n  color = '#34383a',\n  ...props\n}, ref) => {\n  let api\n  let baseRef = ref || useRef();\n  [baseRef, api] = useBox({}, ref)\n  const [material] = useState(new THREE.MeshLambertMaterial({ color, transparent: true, opacity: 1, wireframe: false }))\n\n  useCollision(() => {\n    api.destroy(baseRef.current?.uuid)\n    anime({\n      easing: 'linear',\n      duration: 500,\n      opacity: 0,\n      targets: material,\n      complete: () => {\n        baseRef.current.visible = false\n      },\n    })\n  }\n  , baseRef.current?.uuid)\n\n  return useMemo(() => {\n    console.log('RENDER WALL')\n    return (\n      <>\n        <mesh\n          ref={baseRef}\n          rotation={[-Math.PI / 2, 0, rotate]}\n          {...props}\n          userData={{\n            origin: props.position,\n            static: true,\n            hx: hx/2,\n            hy: hy/2,\n            rotate: false,\n            angle: rotate,\n            isWall: true,\n          }}\n          material={material}\n          castShadow\n        >\n          <boxBufferGeometry args={[hx, hy, hy/2, 10]} />\n          {/* <meshStandardMaterial color={'orange'} /> */}\n        </mesh>\n      </>\n    )\n  }\n  , [])\n})","const crystalMinTimeToAppear = 16000\nconst levels = [\n  {\n    id: 1,\n    arena: {\n      name: 'Granite',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#999999',\n      walls: [],\n    },\n    crystals: [{\n      type: 'grow',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 2,\n    }],\n  }, {\n    id: 2,\n    arena: {\n      name: 'Sand',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#9c6135',\n      walls: [],\n    },\n    crystals: [{\n      type: 'coil',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 2,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 3,\n    }],\n  }, {\n    id: 3,\n    arena: {\n      name: 'Malaquite',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#60944a',\n      walls: [],\n    },\n    crystals: [{\n      type: 'freezer',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 2,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n  }, {\n    id: 4,\n    arena: {\n      name: 'Turquoise',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#479186',\n      walls: [{\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [0, -0.22, -8],\n      }, {\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [-4, -0.22, -8],\n      }, {\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [4, -0.22, -8],\n      }, {\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [0, -0.22, 8],\n      }, {\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [-4, -0.22, 8],\n      }, {\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [4, -0.22, 8],\n      }],\n    },\n    crystals: [{\n      type: 'grow',\n      position: [-4, 0.21, 4],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'coil',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'freezer',\n      position: [4, 0.21, -4],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 2,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      model: 4,\n    },],\n  }, {\n    id: 5,\n    arena: {\n      name: 'Aragonite',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#ff5e00',\n      walls: [{\n          color: '#ff5e00',\n          position: [-8, -0.22, 0],\n       }, {\n         color: '#ff5e00',\n         position: [8, -0.22, 0],\n       }, {\n         color: '#ff5e00',\n         rotate: Math.PI / 2,\n         position: [0, -0.22, -8],\n       }, {\n         color: '#ff5e00',\n         rotate: -Math.PI / 2,\n         position: [0, -0.22, 8],\n       }],\n    },\n    crystals: [{\n      type: 'freezer',\n      position: [-4, 0.21, -4],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'grow',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'coil',\n      position: [4, 0.21, 4],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [0, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, 0],\n      color: '#9e18aa',\n      model: 2,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, 0],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [0, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n  }, {\n    id: 6,\n    arena: {\n      name: 'Jasper',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#ad1a2b',\n      walls: [{\n          color: '#ad1a2b',\n          position: [-8, -0.22, -5.5],\n       }, {\n          color: '#ad1a2b',\n          rotate: Math.PI / 2,\n          position: [-5.5, -0.22, -8],\n       }, {\n          color: '#ad1a2b',\n          position: [8, -0.22, 5.5],\n       }, {\n          color: '#ad1a2b',\n          position: [8, -0.22, -5.5],\n       }, {\n         color: '#ad1a2b',\n         rotate: Math.PI / 2,\n         position: [5.5, -0.22, -8],\n       }, {\n         color: '#ad1a2b',\n         rotate: Math.PI / 2,\n         position: [5.5, -0.22, 8],\n       }, {\n         color: '#ad1a2b',\n         rotate: -Math.PI / 2,\n         position: [-5.5, -0.22, 8],\n       }, {\n          color: '#ad1a2b',\n          position: [-8, -0.22, 5.5],\n       }],\n    },\n    crystals: [{\n      type: 'coil',\n      position: [5, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'freezer',\n      position: [0, 0.21, 5],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'grow',\n      position: [-5, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      model: 2,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n  }, {\n    id: 7,\n    arena: {\n      name: 'Amethyst',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#471182',\n      walls: [{\n          color: '#471182',\n          position: [-8, -0.22, 0],\n       }, {\n          color: '#471182',\n          position: [8, -0.22, 0],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [0, 0, 0],\n      hx: 14,\n      hy: 0.5,\n      // rotate: Math.PI / 4,\n    }],\n    crystals: [{\n      type: 'grow',\n      position: [-5, 0.21, -1],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'coil',\n      position: [-5, 0.21, 5],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'freezer',\n      position: [5, 0.21, 5],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [0, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy2',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [0, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n  }, {\n    id: 8,\n    arena: {\n      name: 'Topaz',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#1676a6',\n      walls: [{\n          // West-Middle\n          color: '#1676a6',\n          position: [-8, -0.22, 0],\n       }, {\n          // West-North\n          color: '#1676a6',\n          position: [-8, -0.22, -6],\n       }, {\n          // North-West\n          color: '#1676a6',\n          rotate: Math.PI / 2,\n          position: [-6, -0.22, -8],\n       }, {\n          // Morth-Middle\n          color: '#1676a6',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, -8],\n       }, {\n          // East-North\n          color: '#1676a6',\n          position: [8, -0.22, -6],\n       }, {\n          // East-South\n          color: '#1676a6',\n          position: [8, -0.22, 6],\n       }, {\n          // South-East\n          color: '#1676a6',\n          rotate: Math.PI / 2,\n          position: [6, -0.22, 8],\n       }, {\n          // North-East\n          color: '#1676a6',\n          rotate: Math.PI / 2,\n          position: [5.5, -0.22, -8],\n       },{\n          // West-South\n          color: '#1676a6',\n          position: [-8, -0.22, 6],\n       }, {\n          // South-West\n          color: '#1676a6',\n          rotate: -Math.PI / 2,\n          position: [-5.5, -0.22, 8],\n       }, {\n          // South-Middle\n          color: '#1676a6',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, 8],\n       }, {\n          // Middle-Cross\n          color: '#1676a6',\n          position: [8, -0.22, 0],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [-2, 0, -2],\n      hx: 2,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [2, 0, 2],\n      hx: 2,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [2, 0, -2],\n      hx: 2,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [-2, 0, 2],\n      hx: 2,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }],\n    crystals: [{\n      type: 'freezer',\n      position: [2, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'grow',\n      position: [-2, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'coil',\n      position: [0, 0.21, -2],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3\n    }, {\n      id: 'enemy2',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 3,\n    }],\n  }, {\n    id: 9,\n    arena: {\n      name: 'Sulfur',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#ebb800',\n      walls: [{\n          color: '#ff5e00',\n          position: [-8, -0.22, 0],\n       }, {\n         color: '#ff5e00',\n         position: [8, -0.22, 0],\n       }, {\n         color: '#ff5e00',\n         rotate: Math.PI / 2,\n         position: [0, -0.22, -8],\n       }, {\n         color: '#ff5e00',\n         rotate: -Math.PI / 2,\n         position: [0, -0.22, 8],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [-5, 0, 0],\n      hx: 2,\n      hy: 8,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [5, 0, 0],\n      hx: 2,\n      hy: 8,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [0, 0, -5],\n      hx: 8,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [0, 0, 5],\n      hx: 8,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }],\n    crystals: [{\n      type: 'coil',\n      position: [0, 0.21, 7],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'freezer',\n      position: [-7, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'grow',\n      position: [7, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [0, 0.22, 0],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [-5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      model: 4\n    }, {\n      id: 'enemy4',\n      position: [5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n  }, {\n    id: 10,\n    arena: {\n      name: 'Graphite',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#33312f',\n      walls: [{\n          // West-Middle\n          color: '#33312f',\n          position: [-8, -0.22, 0],\n       }, {\n          // West-North\n          color: '#33312f',\n          position: [-8, -0.22, -6],\n       }, {\n          // North-West\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [-6, -0.22, -8],\n       }, {\n          // Morth-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, -8],\n       }, {\n          // East-North\n          color: '#33312f',\n          position: [8, -0.22, -6],\n       }, {\n          // East-South\n          color: '#33312f',\n          position: [8, -0.22, 6],\n       }, {\n          // South-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [6, -0.22, 8],\n       }, {\n          // North-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [5.5, -0.22, -8],\n       },{\n          // West-South\n          color: '#33312f',\n          position: [-8, -0.22, 6],\n       }, {\n          // South-West\n          color: '#33312f',\n          rotate: -Math.PI / 2,\n          position: [-5.5, -0.22, 8],\n       }, {\n          // South-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, 8],\n       }, {\n          // Middle-Cross\n          color: '#33312f',\n          position: [8, -0.22, 0],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [0, 0, 0],\n      hx: 14,\n      hy: 0.5,\n      // rotate: Math.PI / 4,\n    }],\n    crystals: [{\n      type: 'coil',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'freezer',\n      position: [-5, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'grow',\n      position: [5, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [-0, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy2',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, 1],\n      color: '#9e18aa',\n      model: 4,\n    }, {\n      id: 'enemy4',\n      position: [5.1, 0.22, -1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n    portalGroups: [\n      [{ position: [-6, -0.3, -6]}, {position: [6, -0.3, 6]}],\n    ],\n  }, {\n    id: 11,\n    arena: {\n      name: 'The roof',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#33312f',\n      walls: [{\n          // West-Middle\n          color: '#33312f',\n          position: [-8, -0.22, 0],\n       }, {\n          // West-North\n          color: '#33312f',\n          position: [-8, -0.22, -6],\n       }, {\n          // North-West\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [-6, -0.22, -8],\n       }, {\n          // Morth-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, -8],\n       }, {\n          // East-North\n          color: '#33312f',\n          position: [8, -0.22, -6],\n       }, {\n          // East-South\n          color: '#33312f',\n          position: [8, -0.22, 6],\n       }, {\n          // South-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [6, -0.22, 8],\n       }, {\n          // North-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [5.5, -0.22, -8],\n       },{\n          // West-South\n          color: '#33312f',\n          position: [-8, -0.22, 6],\n       }, {\n          // South-West\n          color: '#33312f',\n          rotate: -Math.PI / 2,\n          position: [-5.5, -0.22, 8],\n       }, {\n          // South-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, 8],\n       }, {\n          // Middle-Cross\n          color: '#33312f',\n          position: [8, -0.22, 0],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [-6, -0.3, -6],\n      hx: 2,\n      hy: 2,\n    }, {\n      position: [-6, -0.3, 6],\n      hx: 2,\n      hy: 2,\n    }],\n    crystals: [{\n      type: 'freezer',\n      position: [6, 0.21, 6],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'coil',\n      position: [-6, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'grow',\n      position: [6, 0.21, -6],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [0, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy2',\n      position: [2.5, 0.22, -5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, -2.5],\n      color: '#9e18aa',\n      model: 4,\n    }, {\n      id: 'enemy4',\n      position: [5.1, 0.22, 0],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 4,\n    }],\n    portalGroups: [\n      [{ position: [-6, -0.3, -6]}, {position: [6, -0.3, 6]}],\n      [{ position: [-6, -0.3, 6]}, {position: [6, -0.3, -6]}],\n    ],\n  }, {\n    id: 12,\n    arena: {\n      name: 'The castle',\n      texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#33312f',\n      walls: [{\n          // West-Middle\n          color: '#33312f',\n          position: [-8, -0.22, 0],\n       }, {\n          // West-North\n          color: '#33312f',\n          position: [-8, -0.22, -6],\n       }, {\n          // North-West\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [-6, -0.22, -8],\n       }, {\n          // Morth-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, -8],\n       }, {\n          // East-North\n          color: '#33312f',\n          position: [8, -0.22, -6],\n       }, {\n          // East-South\n          color: '#33312f',\n          position: [8, -0.22, 6],\n       }, {\n          // South-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [6, -0.22, 8],\n       }, {\n          // North-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [5.5, -0.22, -8],\n       },{\n          // West-South\n          color: '#33312f',\n          position: [-8, -0.22, 6],\n       }, {\n          // South-West\n          color: '#33312f',\n          rotate: -Math.PI / 2,\n          position: [-5.5, -0.22, 8],\n       }, {\n          // South-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, 8],\n       }, {\n          // Middle-Cross\n          color: '#33312f',\n          position: [8, -0.22, 0],\n       }, {\n          // Xtra 1\n          color: '#262523',\n          rotate: Math.PI / 2,\n          position: [-2.5, -0.22, 7.5],\n       }, {\n          // Xtra 2\n          color: '#262523',\n          rotate: Math.PI / 2,\n          position: [3, -0.22, 7.5],\n       }, {\n          // Xtra 3\n          color: '#262523',\n          rotate: Math.PI / 2,\n          position: [2.5, -0.22, -7.5],\n       }, {\n          // Xtra 4\n          color: '#262523',\n          rotate: Math.PI / 2,\n          position: [-3, -0.22, -7.5],\n       }, {\n          // Xtra 5\n          color: '#262523',\n          position: [-7.5, -0.22, -3],\n       }, {\n          // Xtra 6\n          color: '#262523',\n          position: [7.5, -0.22, -3],\n       }, {\n          // Xtra 7\n          color: '#262523',\n          position: [7.5, -0.22, 3],\n       }, {\n          // Xtra 8\n          color: '#262523',\n          position: [-7.5, -0.22, 3],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [0, 0, 0],\n      hx: 4,\n      hy: 4,\n    }],\n    crystals: [{\n      type: 'coil',\n      position: [6, 0.21, 6],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'grow',\n      position: [-6, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'freezer',\n      position: [6, 0.21, -6],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [0, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [-2.5, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 4,\n    }, {\n      id: 'enemy3',\n      position: [2.5, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4,\n    }, {\n      id: 'enemy4',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 4,\n    }],\n    portalGroups: [\n      [{ position: [-5.1, 0, 0]}, {position: [5.1, 0, 0]}],\n    ],\n  }\n]\n\n\nexport default levels\n","import React, { useState, useEffect, useRef } from 'react'\nimport { Html, useAspect } from 'drei'\nimport { Dimensions } from 'react-native'\nimport { useThree } from 'react-three-fiber'\nimport { useEvents } from '../../systems/World/hooks'\nimport { GAME_EVENTS } from '../../systems/World/Events'\nimport anime from '../../helpers/anime';\n\nconst CountDown = () => {\n  const [count, setCount] = useState()\n  const [start, setStart] = useState()\n  const gameReadyTrigger = useEvents(GAME_EVENTS.READY_ON)\n  const systemOnlineTrigger = useEvents(GAME_EVENTS.SYSTEM_ONLINE)\n  const { camera } = useThree()\n  const tId = useRef()\n  useEffect(() => {\n    if (count === 0) {\n      gameReadyTrigger()\n    } else {\n      if (count !== undefined) {\n        tId.current = setTimeout(() => {\n          setCount(count - 1)\n        }, 1000)\n      }\n    }\n    () => {\n      clearTimeout(tId.current)\n    }\n  }, [count])\n  useEffect(() => {\n    if (!start) return\n    const destination = {...camera.position}\n    console.log(destination)\n    camera.position.x = -3\n    camera.position.y = -15\n    camera.position.z = 10\n    camera.lookAt(0, 0, 3)\n    const targetObj = { ...camera.position }\n    anime({\n      easing: Math.random() > 0.5 ? 'easeInOutExpo' : 'easeInOutBack',\n      duration: 6000,\n      x: destination.x,\n      y: destination.y,\n      z: destination.z,\n      targets: targetObj,\n      update: function () {\n        camera.position.x = targetObj.x\n        camera.position.y = targetObj.y\n        camera.position.z = targetObj.z\n        camera.lookAt(0, 0, 3)\n      },\n      complete: function () {\n        setCount(3)\n      }\n    })\n  }, [start])\n  useEffect(() => {\n    setTimeout(() => {\n      systemOnlineTrigger()\n      setStart(true)\n    }, 2000)\n  }, [camera])\n  const scale = useAspect(\n    \"cover\",\n    Dimensions.get(\"window\").width,\n    Dimensions.get(\"window\").height,\n    1\n  )\n  return (\n    <Html scaleFactor={scale} position={[-scale.width, 0, -scale.height]}>\n      { count !== 0 &&\n        <div\n          className=\"content\"\n          style={{\n            // border: '1px solid red',\n            color: 'white',\n            fontFamily: 'Arial',\n            fontWeight: 'bold',\n            display: 'flex',\n            flex: 1,\n            width: '100vw',\n            height: '100vh',\n            boxSizing: 'border-box',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}>\n          <span style={{ fontSize: 180 }}>{count}</span>\n        </div>\n      }\n    </Html>\n  )\n}\nexport default CountDown","import React, { Suspense, useEffect, useRef, useState } from 'react'\nimport { Canvas } from 'react-three-fiber'\nimport { OrbitControls, Stars, axesHelper, Html } from 'drei'\n// import { EffectComposer, Outline, Bloom, SelectiveBloom } from '@react-three/postprocessing'\nimport Enemy from '../../components/Enemy'\nimport Player from '../../components/Player'\nimport { Physics } from '../../systems/Physics'\nimport { WorldEvents } from '../../systems/World'\nimport { useEvents } from '../../systems/World/hooks'\nimport { Controllers, getPlayers } from '../../systems/HUD'\nimport Rock from '../../components/RockCube'\n// import Sparks from '../Sparks'\nimport Crystal from '../../components/Crystal'\nimport Wall from '../../components/Wall'\nimport { THREE } from 'expo-three';\nimport { CHARACTER_EVENTS, GAME_EVENTS } from '../../systems/World/Events'\nimport {\n  SIMPLE_HIT,\n  GAME_OVER,\n  GAME_WON,\n  ENEMY_DOWN,\n  SCENE_LOADED,\n  OVERCHARGED,\n  FROZEN,\n  COILED,\n  TELEPORTED,\n  IMPULSE_ON,\n  IMPULSE_OFF,\n  GROWN,\n} from '../../constants/webView_comm_messages'\nimport LEVELS from '../../constants/levels'\nimport useTimeout from '../../hooks/useTimeout'\nimport CountDown from '../../components/CountDown'\n// import PosIndicator from '../../components/PosIndicator'\nimport RevertSpinArea from '../../components/RevertSpinArea'\nimport Portals from '../../components/Portals'\nimport { useApi } from '../../systems/Physics/hooks'\n\nconst THEME_TRON = {\n  player_color: '#0ac757',\n  enemy1_color: '#9e18aa',\n  tubular_wall1_color: '#f737f7',\n  tubular_wall2_color: '#35e0df',\n}\nconst THEME_KENNEY = {}\n// const CURRENT_LEVEL = window.currentLevel ? LEVELS[window.currentLevel] : LEVELS[0]\n\nconst [player1, player2] = getPlayers(2)\nlet playersOnArena = [];\nlet playerRef;\nconst useLevels = levelId => {\n  const CURRENT_LEVEL = LEVELS[levelId]\n  const enemyRefs = CURRENT_LEVEL.enemies.map(() => useRef(null))\n  const wallRefs = CURRENT_LEVEL.arena.walls.map(() => useRef())\n  playerRef = useRef(null)\n  const pos = useRef(CURRENT_LEVEL.enemies.length + 1)\n  useEvents(CHARACTER_EVENTS.OUT_OF_RING, characterRef => {\n    const isUserFall = characterRef === playerRef\n    const playersAlive = playersOnArena.filter(pRef => pRef !== characterRef)\n    const thereArePlayersLeft = playersAlive.length > 0\n    const onlyOnePlayersLeft = playersAlive.length === 1\n    const userIsAlive = playersAlive.find(pRef => pRef === playerRef)\n    if (!isUserFall && userIsAlive) {\n      pos.current = pos.current - 1\n      window.ReactNativeWebView?.postMessage(`${ENEMY_DOWN}:${pos.current}`);\n    }\n    if (thereArePlayersLeft && isUserFall) {\n      setTimeout(() => {\n        console.log('game over', GAME_OVER, pos.current)\n        window.ReactNativeWebView?.postMessage(`${GAME_OVER}:${pos.current}`);\n      }\n      , 1000)\n    }\n    if (userIsAlive && onlyOnePlayersLeft) {\n      setTimeout(() => {\n        console.log('game win', GAME_WON)\n        window.ReactNativeWebView?.postMessage(GAME_WON);\n      }\n      , 1000)\n    }\n    playersOnArena = playersAlive;\n  })\n  playersOnArena.push(...[playerRef, ...enemyRefs])\n  return [\n    <Player\n      position={CURRENT_LEVEL.player.position}\n      radius={0.5}\n      userController={player2}\n      color={CURRENT_LEVEL.player.color}\n      ref={playerRef}\n    />,\n    CURRENT_LEVEL.enemies.map((enemy, idx) => \n      <Enemy\n        key={enemy.id}\n        position={enemy.position}\n        radius={0.5}\n        color={enemy.color}\n        ref={enemyRefs[idx]}\n        enemies={[playerRef]}\n        model={enemy.model}\n        spin={enemy.spin}\n      />\n    ),\n    CURRENT_LEVEL.arena.walls.map((wall, idx) =>\n      <Wall\n        key={`wall_${idx}`}\n        position={wall.position}\n        color={wall.color}\n        rotate={wall.rotate}\n        hx={0.25}\n        hy={3}\n        ref={wallRefs[idx]}\n      />\n    ),\n    CURRENT_LEVEL.crystals.map((crystal, idx) =>\n      <Crystal\n        key={`crystal_${idx}`}\n        position={crystal.position}\n        scale={[1.5, 1.5, 1.5]}\n        type={crystal.type}\n        timeToAppear={crystal.timeToAppear}\n      />\n    ),\n    CURRENT_LEVEL.portalGroups?.map((portals, idx) =>\n      <Portals\n        key={`portals_${idx}`}\n        positionBlue={portals[1].position}\n        positionRed={portals[0].position}\n      />\n    ),\n    CURRENT_LEVEL.spinReverseAreas?.map((area, idx) =>\n      <RevertSpinArea\n        key={`spin_area_${idx}`}\n        position={area.position}\n        hx={area.hx}\n        hy={area.hy}\n        rotate={area.rotate}\n      />\n    )\n  ]\n}\n\nconst GameScene = ({ onLoad, currentLevel = 0 }) => {\n  console.log(currentLevel)\n  const [player, enemies, walls, crystals, portals, spinReverseAreas] = useLevels(currentLevel)\n  const arena = LEVELS[currentLevel].arena\n\n  useEvents(CHARACTER_EVENTS.BEGIN_CONTACT, contact => {\n    const fixtureA = contact.GetFixtureA()\n    const fixtureB = contact.GetFixtureB()\n    const dataA = fixtureA.GetBody().GetUserData()\n    const dataB = fixtureB.GetBody().GetUserData()\n    if ((dataA.isPlayer || dataA.isEnemy || dataA.isWall) && (dataB.isPlayer || dataB.isEnemy || dataB.isWall)) {\n      window.ReactNativeWebView?.postMessage(SIMPLE_HIT);\n    }\n  })\n  useEvents(GAME_EVENTS.SYSTEM_ONLINE, () => {\n    window.ReactNativeWebView?.postMessage(SCENE_LOADED);\n  })\n  useEvents(CHARACTER_EVENTS.GETS_FREEZER, () => {\n    window.ReactNativeWebView?.postMessage(FROZEN);\n  })\n  useEvents(CHARACTER_EVENTS.GETS_COIL, () => {\n    window.ReactNativeWebView?.postMessage(COILED);\n  })\n  useEvents(CHARACTER_EVENTS.OVERCHARGE, () => {\n    window.ReactNativeWebView?.postMessage(OVERCHARGED);\n  })\n  useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_GROW, () => {\n    window.ReactNativeWebView?.postMessage(GROWN);\n  })\n  useEvents(CHARACTER_EVENTS.TELEPORT, () => {\n    window.ReactNativeWebView?.postMessage(TELEPORTED);\n  })\n  useEvents(CHARACTER_EVENTS.IMPULSE_ON, ({uuid, api}) => {\n    const data = api.getPhysicsUserData(uuid)\n    window.ReactNativeWebView?.postMessage(`${IMPULSE_ON}:${data.model}`);\n  })\n  useEvents(CHARACTER_EVENTS.IMPULSE_OFF, ({uuid, api}) => {\n    const data = api.getPhysicsUserData(uuid)\n    window.ReactNativeWebView?.postMessage(`${IMPULSE_OFF}:${data.model}`);\n  })\n  \n  \n  \n  return (\n    <>\n      <WorldEvents>\n        <Canvas\n          style={{ background: \"#171717\" }}\n          shadowMap\n          // invalidateFrameloop\n          // pixelRatio={Dimensions.get('window').height / Dimensions.get('window').width}\n          camera={{ position: [-5, 11, 20], fov: 30 }}\n          concurrent\n          gl={{ antialias: true }}\n          onCreated={({ gl, camera }) => {\n            camera.lookAt(0, 0, 3)\n            // onLoad()\n          }}\n        >\n          {/* <PosIndicator /> */}\n          <CountDown />\n          {/* <pointLight color=\"0xffffff\" intensity={1} distance={10} position={[0, 50, 0]} />\n          <pointLight color=\"0xffffff\" intensity={0.2} distance={10} position={[-5, 50, 0]} /> */}\n          <ambientLight intensity={1} color=\"#dadada\"/>\n        \n          <pointLight position={[-5, 50, 0]} intensity={0.2} distance={10} color=\"lightblue\" />\n          \n          <directionalLight\n            castShadow\n            position={[5, 8, -5]}\n            intensity={0.5}\n            // color=\"#ff9760\"\n            color=\"#ffffff\"\n            shadow-mapSize-width={600}\n            shadow-mapSize-height={600}\n            shadow-camera-far={50}\n            shadow-camera-left={-10}\n            shadow-camera-right={10}\n            shadow-camera-top={10}\n            shadow-camera-bottom={-10}\n            />\n          <Physics>\n            {crystals}\n            {enemies}\n            {player}\n            {walls}\n            {portals}\n            {spinReverseAreas}\n          </Physics>\n          <Suspense fallback={null}>\n            <Rock\n              texture={arena.texture}\n              tint={arena.tint}\n              name={arena.name}\n              scale={[16, 16, 16]}\n              position={[0, -8, 0]}\n              receiveShadow\n            />\n          </Suspense>\n          {/* <UfoBase position={[0, 0.15, 0]} /> */}\n          {/* <Arena/> */}\n          {/* <Arena3 /> */}\n          {/* <EffectComposer>\n          </EffectComposer> */}\n            {/* <Bloom luminanceThreshold={0.01} luminanceSmoothing={1} height={100} /> */}\n            {/* <Outline selection={[wallRef1, wallRef2, wallRef3, wallRef4]} visibleEdgeColor=\"#ffffff\" edgeStrength={1} pulseSpeed={1} blur={true} /> */}\n          {/* <Sparks count={50} mouse={sparkRef} colors={['#182825', '#016FB9', '#22AED1', '#6D8EA0', '#224870', '#224870']} /> */}\n          \n          {/* <OrbitControls /> */}\n          {/* <axesHelper /> */}\n          {/* <gridHelper args={[30, 30, 30]} /> */}\n          <Stars/>\n        </Canvas>\n      </WorldEvents>\n      <Controllers forPlayers={[player1, player2]} noUI/>\n    </>\n  );\n};\n\nexport default GameScene;\n","import React, { forwardRef, useRef, useEffect, useState } from 'react'\nimport { THREE } from 'expo-three';\nimport { useBox } from '../../systems/Physics/hooks'\nimport useCollision from '../../hooks/useCollision'\nimport { useEvents } from '../../systems/World/hooks';\nimport { CHARACTER_EVENTS } from '../../systems/World/Events';\n\nexport default forwardRef(({\n  hx = 4,\n  hy = 4,\n  rotate = 0,\n  color = 'red',\n  ...props\n}, ref) => {\n  let api\n  let baseRef = ref || useRef();\n  [baseRef, api] = useBox({}, ref)\n  const [material] = useState(new THREE.MeshNormalMaterial({ color, transparent: true, opacity: 0.25, wireframe: false }))\n  const spinRevertTrigger = useEvents(CHARACTER_EVENTS.EXTERNAL_SPIN_CHANGE)\n\n  useCollision(collidedFixture => {\n    const uuid = collidedFixture.GetBody().GetUserData().uuid\n    api.revertSpin(uuid)\n    spinRevertTrigger(uuid)\n  }\n  , baseRef.current?.uuid)\n\n  return (\n    <mesh\n      ref={baseRef}\n      rotation={[0, 0, 0]}\n      {...props}\n      userData={{ origin: props.position, pickable: true, hx: hx/2, hy: hy/2, rotate: false, angle: rotate }}\n      material={material}\n      // castShadow\n    >\n      <boxBufferGeometry args={[hx, 0.2, hy, 10]} />\n      {/* <meshStandardMaterial color={'orange'} /> */}\n    </mesh>\n  )\n})","import React, { useRef, forwardRef, useState, useEffect } from 'react'\nimport { useLoader } from 'react-three-fiber'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/round_base/towerRound_base.obj'\nimport modelMtl from '../../../assets/round_base/towerRound_base.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\n// const assetURL = 'https://raw.githubusercontent.com/Cosmitar/threejs_assets/master/ufo_ships/enemy_ufoPurple.glb'\n\nconst getGradientMap = color => {\n  const alphaIndex = 1\n  const colors = new Uint8Array( alphaIndex + 2 )\n\n  for ( let c = 0; c <= colors.length; c ++ ) {\n\n    colors[ c ] = ( c / colors.length ) * 256;\n\n  }\n\n  const gradientMap = new THREE.DataTexture( colors, colors.length, 1, THREE.LuminanceFormat );\n  gradientMap.minFilter = THREE.NearestFilter;\n  gradientMap.magFilter = THREE.NearestFilter;\n  gradientMap.generateMipmaps = false;\n  return gradientMap\n}\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const matTest = new THREE.MeshBasicMaterial({ color: 'lime' })\n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialCore = colorPalette[2] ? new THREE.MeshToonMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialDeco// red\n    obj.children[0].material[1] = materialChassis// stone\n    obj.children[0].material[2] = materialDome// stoneDark\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return (\n    <group\n      ref={fwdRef}\n      {...moreProps}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n      <mesh\n        rotation={[Math.PI, 0, 0]}\n        position={[0, 0.5, 0]}\n      >\n        <coneBufferGeometry args={[0.5, 1.5, 32]}/>\n        <meshLambertMaterial color={colorPalette[0]} opacity={0.3} transparent />\n      </mesh>\n    </group>\n  )\n})","import React, { useRef } from 'react'\nimport { useApi, useCircle } from '../../systems/Physics/hooks'\nimport useCollision from '../../hooks/useCollision'\nimport UfoBase from '../UfoBase'\nimport { useEvents } from '../../systems/World/hooks'\nimport { CHARACTER_EVENTS } from '../../systems/World/Events'\n\nconst Portals = ({ positionBlue = [0,0,0], positionRed = [5, 0, 5]}) => {\n  const [portalBlue] = useCircle({})\n  const [portalRed] = useCircle({})\n  let teleporting = useRef([]).current\n  const api = useApi()\n  const onTeleportTrigger = useEvents(CHARACTER_EVENTS.TELEPORT)\n  useCollision(collidedFixture => {\n    const uuid = collidedFixture.GetBody().GetUserData().uuid\n    if (!teleporting.includes(uuid)) {\n      teleporting.push(uuid)\n      setTimeout(() => {\n        api.hyperJump(\n          uuid,\n          { x: positionRed[0], y: positionRed[2] }\n        )\n        onTeleportTrigger()\n      }, 0)\n    } else {\n      teleporting = teleporting.filter(id => id !== uuid)\n    }\n  }, portalBlue.current?.uuid)\n  useCollision(collidedFixture => {\n    const uuid = collidedFixture.GetBody().GetUserData().uuid\n    if (!teleporting.includes(uuid)) {\n      teleporting.push(uuid)\n      setTimeout(() => {\n        api.hyperJump(\n          collidedFixture.GetBody().GetUserData().uuid,\n          { x: positionBlue[0], y: positionBlue[2] }\n        )\n        onTeleportTrigger()\n      }, 0);\n    } else {\n      teleporting = teleporting.filter(id => id !== uuid)\n    }\n  }, portalRed.current?.uuid)\n\n  return (\n    <>\n      <UfoBase\n        ref={portalBlue}\n        colorPalette={[\n          '#32aaf8',\n          '#ff2147',\n          '#878787',\n          '#e4e4ef'\n        ]}\n        position={positionBlue}\n        userData={{ origin: positionBlue, pickable: true, radius: 0.25, rotate: false }}\n      />\n        \n      <UfoBase\n        ref={portalRed}\n        colorPalette={[\n          '#ff2147',\n          '#32aaf8',\n          '#878787',\n          '#e4e4ef'\n        ]}\n        position={positionRed}\n        userData={{ origin: positionRed, pickable: true, radius: 0.25, rotate: false }}\n      />\n    </>\n  )\n}\n\nexport default Portals","import EventsService from '../../helpers/eventsService'\nimport Controllers from './Controllers'\n\nconst getPlayers = amount => {\n  return Array(amount).fill(0).map(() => \n    new EventsService\n  )\n}\n\nexport {\n  Controllers,\n  getPlayers,\n}\n","export const ON_LINE_NOTIFICATION = 'SS@system_online'\nexport const SCENE_LOADED = 'SS@scene_loaded'\nexport const TITLES_LOADED = 'SS@titles_scene_loaded'\nexport const SIMPLE_HIT = 'SS@hit'\nexport const GAME_OVER = 'SS@game_over'\nexport const GAME_WON = 'SS@game_won'\nexport const ENEMY_DOWN = 'SS@enemy_down'\nexport const FROZEN = 'SS@ufo_frozen'\nexport const COILED = 'SS@ufo_coiled'\nexport const OVERCHARGED = 'SS@ufo_overcharged'\nexport const GROWN = 'SS@ufo_magnified'\nexport const TELEPORTED = 'SS@ufo_teleported'\nexport const IMPULSE_ON = 'SS@ufo_impule_on'\nexport const IMPULSE_OFF = 'SS@ufo_impulse_off'\nexport const THE_END_BEGINS = 'SS@the_end_begins'\nexport const THE_END_ENDS = 'SS@the_end_ends'","import { THREE } from 'expo-three'\nimport React, { useRef, useMemo } from 'react'\nimport { extend, useFrame, useThree } from 'react-three-fiber'\nimport lerp from 'lerp'\nimport * as meshline from 'threejs-meshline'\n\nextend(meshline)\n\nconst r = () => Math.max(0.2, Math.random())\n\nfunction Fatline({ curve, width, color, speed }) {\n  const material = useRef()\n  useFrame(() => (material.current.uniforms.dashOffset.value -= speed))\n  return (\n    <mesh>\n      <meshLine attach=\"geometry\" vertices={curve} />\n      <meshLineMaterial attach=\"material\" ref={material} transparent depthTest={false} lineWidth={width} color={color} dashArray={0.1} dashRatio={0.95} />\n    </mesh>\n  )\n}\n\nexport default function Sparks({ mouse = useRef([]), count, colors, radius = 10 }) {\n  const lines = useMemo(\n    () =>\n      new Array(count).fill().map((_, index) => {\n        const pos = new THREE.Vector3(Math.sin(0) * radius * r(), Math.cos(0) * radius * r(), 0)\n        const points = new Array(30).fill().map((_, index) => {\n          const angle = (index / 20) * Math.PI * 2\n          return pos.add(new THREE.Vector3(Math.sin(angle) * radius * r(), Math.cos(angle) * radius * r(), 0)).clone()\n        })\n        const curve = new THREE.CatmullRomCurve3(points).getPoints(1000)\n        return {\n          color: colors[parseInt(colors.length * Math.random())],\n          width: Math.max(0.1, (0.2 * index) / 50),\n          speed: Math.max(0.001, 0.004 * Math.random()),\n          curve\n        }\n      }),\n    [count]\n  )\n\n  const ref = useRef()\n  const { size, viewport } = useThree()\n  const aspect = size.width / viewport.width\n  useFrame(() => {\n    if (ref.current) {\n      ref.current.rotation.x = lerp(ref.current.rotation.x, 0 + mouse.current[1] / aspect / 200, 0.1)\n      ref.current.rotation.y = lerp(ref.current.rotation.y, 0 + mouse.current[0] / aspect / 400, 0.1)\n    }\n  })\n\n  return (\n    <group ref={ref}>\n      <group position={[-radius * 2, -radius, -10]} scale={[1, 1.3, 1]}>\n        {lines.map((props, index) => (\n          <Fatline key={index} {...props} />\n        ))}\n      </group>\n    </group>\n  )\n}\n","import React, { Suspense, useEffect, useRef, useState } from 'react'\nimport { useFrame } from 'react-three-fiber'\nimport Ufo from './../../components/UfoModels/UfoModel1'\n\nexport default () => {\n  const [spin, setSpin] = useState()\n  const ufoRef = useRef()\n  useFrame(() => {\n    if (ufoRef?.current && spin) {\n      ufoRef.current.rotation.y += 0.03;\n    }\n  })\n\n  useEffect(() => {\n    setSpin(true)\n  }, [])\n  return (\n    <Ufo\n      ref={ufoRef}\n      colorPalette={[\n        // '#b4b4d8',\n        // '#ea5627',\n        // '#1f1f7b',\n        // '#e4e4ef'\n\n        '#999106',\n        '#990606',\n        '#000000',\n        '#e4e4ef'\n      ]}\n      position={[0, 0, 0]}\n    />\n  )\n}","import React, { useState, useEffect, useRef } from 'react'\nimport { useThree } from 'react-three-fiber'\nimport anime from '../../helpers/anime';\n\nconst CameraAnimation = () => {\n  const { camera } = useThree()\n  useEffect(() => {\n    // const destination = {...camera.position}\n    // camera.position.x = -3\n    // camera.position.y = -15\n    // camera.position.z = 10\n    // camera.lookAt(0, 0, 3)\n\n    // 0, 2, 4\n\n    const targetObj = { ...camera.position }\n\n    const timeline = anime.timeline({\n      easing: Math.random() > 0.5 ? 'easeInOutExpo' : 'easeInOutBack',\n      duration: 6000 * 3,\n      targets: camera.position,\n      direction: 'alternate',\n      loop: true,\n      update: function () {\n        camera.lookAt(0, 0, 0)\n      },\n      complete: function () {\n        console.log('complete')\n      }\n    })\n    timeline\n      .add({\n        x: 1.5,\n        y: 2.5,\n        z: 4.3,\n      })\n      .add({\n        x: -1,\n        y: 3,\n        z: 4.5,\n      })\n    \n  }, [])\n  return null\n}\n\nexport default CameraAnimation\n","import React, { Suspense, useEffect, useRef, useState } from 'react'\nimport { BoxHelper, CameraHelper, THREE } from 'expo-three'\nimport { Canvas, useThree } from 'react-three-fiber'\nimport { OrbitControls, Sky, Shadow, PerspectiveCamera, useHelper, gridHelper, Stars, axesHelper } from 'drei'\nimport { EffectComposer, Preload, DepthOfField, Bloom, Noise, Vignette } from \"@react-three/postprocessing\"\nimport { BlendFunction } from 'postprocessing'\n\nimport Ufo from './../../components/UfoModels/UfoModel1'\nimport Ufo2 from './../../components/UfoModels/UfoModel2'\nimport Ufo3 from './../../components/UfoModels/UfoModel3'\nimport Ufo4 from './../../components/UfoModels/UfoModel4'\nimport Sparks from '../../components/Sparks'\nimport Base from './../../components/UfoBase'\nimport UfoPlayer from './UfoPlayer'\nimport CameraAnimation from './CameraAnimation'\nimport Rock from '../../components/RockCube'\nimport { TITLES_LOADED } from '../../constants/webView_comm_messages'\n\nconst textureLoader = new THREE.TextureLoader()\nconst textureMap = textureLoader.load(require('../../../assets/ui/Light rock formation texture.jpg'));\nconst TittlesFloor = () => {\n  // const [textureMap, setTextureMap] = useState()\n  // useEffect(() => {\n  // }, [])\n  return  (\n    <mesh\n      position={[0, -1, 0]}\n    >\n      <boxBufferGeometry args={[15, 1, 15]}/>\n      <meshLambertMaterial color={'#a16215'} map={textureMap}/>\n    </mesh>\n  )\n}\n\nconst LoadingIndicator = ({ onLoad = Function }) => {\n  useEffect(() => {\n    return () => {\n      console.log('fallback load')\n      onLoad()\n    }\n  }, [])\n  return null\n}\n\nexport default ({ onLoad }) => {\n  const ufoRef = useRef()\n  const ufo2Ref = useRef()\n  const ufo3Ref = useRef()\n  const ufo4Ref = useRef()\n  const cameraRef = useRef()\n  const { scene } = useThree()\n  useEffect(() => {\n    if(cameraRef.current) {\n      console.log('TENGO REF')\n      const helper = new THREE.CameraHelper( cameraRef.current );\n      scene.add( helper );\n    }\n    return () => console.log(cameraRef.current)\n  }, [cameraRef])\n  // useHelper(cameraRef, CameraHelper, 1, 'pink')\n  // useHelper(ufoRef, BoxHelper, 'cyan')\n  return (\n    <>\n      <Canvas\n        style={{ background: \"#000000\" }}\n        shadowMap\n        // pixelRatio={Dimensions.get('window').height / Dimensions.get('window').width}\n        camera={{ position: [0, 2, 4], fov: 30 }}\n        concurrent\n        gl={{ antialias: true }}\n        onCreated={({ gl, camera, scene }) => {\n          // camera.lookAt(0, 0, 3)\n          scene.fog = new THREE.Fog('black', 4, 11);\n          window.ReactNativeWebView?.postMessage(TITLES_LOADED);\n        }}\n      >\n        <ambientLight intensity={0.7} color=\"0x888888\"\n          \n        />\n        <pointLight color=\"0xffffff\" intensity={1/2} distance={800} position={[0, 0, 0]} />\n        <pointLight color=\"0xffffff\" intensity={0.2/2} distance={800} position={[-5, 5, 0]} />\n        <CameraAnimation />\n        <Sparks count={50} colors={['#182825', '#016FB9', '#22AED1', '#6D8EA0', '#224870', '#224870']} />\n        <Shadow\n          color=\"cyan\" // Color (default:black)\n          colorStop={0} // First gradient-stop (default:0)\n          opacity={0.5} // Alpha (default:0.5)\n          fog={true} // Reacts to fog (default=false)\n          scale={[1, 1, 1]}\n          rotation={[-Math.PI/2, 0, 0]}\n          position={[0, -0.49, -0]}\n        />\n        <group\n          position={[3, -0.25, -3.5]}\n        >\n          <Rock\n          texture={require('../../../assets/textures/cube_rock_A_mat_baseColor.png')}\n          tint={0xa13f15}\n          scale={[0.5, 0.5, 0.5]}\n          position={[0, 0, 0]}\n        />\n        <Rock\n          texture={require('../../../assets/textures/cube_rock_A_mat_baseColor.png')}\n          tint={0xa13f15}\n          scale={[0.25, 0.25, 0.25]}\n          position={[-0.5, -0.17, -0.5]}\n          rotation={[0, Math.PI / 4, 0]}\n        />\n        </group>\n        <group\n          position={[-3, 0, -3.5]}\n          rotation={[0, Math.PI / 8, 0]}\n        >\n          <Ufo3\n            ref={ufo2Ref}\n            colorPalette={[\n              '#ed34ac',\n              '#5605a8',\n              '#878787',\n              '#e4e4ef'\n            ]}\n            rotation={[0, Math.PI/3, Math.PI/1.5]}\n            position={[-1, 0, -0.5]}\n          />\n          <Ufo2\n            ref={ufo3Ref}\n            // INKY\n            colorPalette={[\n              '#034f82',\n              '#5605a8',\n              '#878787',\n              '#e4e4ef'\n            ]}\n            position={[0, -0.5, 0]}\n          />\n          <Ufo4\n            ref={ufo4Ref}\n            colorPalette={[\n              '#bf0a0a',\n              '#5605a8',\n              '#878787',\n              '#e4e4ef'\n            ]}\n            rotation={[0, 0, -Math.PI/4]}\n            position={[0.5, -0.2, 0]}\n          />\n          <Shadow\n            color=\"black\" // Color (default:black)\n            colorStop={0} // First gradient-stop (default:0)\n            opacity={1} // Alpha (default:0.5)\n            fog={false} // Reacts to fog (default=false)\n            scale={[2, 2, 1]}\n            rotation={[-Math.PI/2, 0, 0]}\n            position={[0, -0.49, 0]}\n          />\n          <Shadow\n            color=\"black\" // Color (default:black)\n            colorStop={0} // First gradient-stop (default:0)\n            opacity={1} // Alpha (default:0.5)\n            fog={true} // Reacts to fog (default=false)\n            scale={[1, 1, 1]}\n            rotation={[-Math.PI/2, 0, 0]}\n            position={[-1, -0.49, -0.5]}\n          />\n        </group>\n        \n        <TittlesFloor />\n        <UfoPlayer />\n        \n        {/* <EffectComposer>\n          <DepthOfField focusDistance={0} focalLength={0.02} bokehScale={2} height={480} />\n          <Vignette\n            offset={0.5} // vignette offset\n            darkness={0.5} // vignette darkness\n            eskil={false} // Eskil's vignette technique\n            blendFunction={BlendFunction.NORMAL} // blend mode\n          />\n        </EffectComposer> */}\n        {/* <OrbitControls /> */}\n        {/* <gridHelper args={[30, 30, 30]} /> */}\n        {/* <axesHelper/> */}\n      </Canvas>\n    </>\n  )\n}","import React, {useRef} from 'react'\nimport { useState } from 'react'\nimport { Image, StyleSheet, View, PanResponder, Text } from 'react-native'\nimport { useFonts } from 'expo-font'\nconst base_skin_stone = require('../../../assets/ui/star_base_stone.png')\nconst base_skin_graphite = require('../../../assets/ui/star_base_graphite.png')\nconst skin_foreground_stone = require('../../../assets/ui/star_filled_stone.png')\nconst skin_foreground_graphite = require('../../../assets/ui/star_filled_graphite.png')\n\nexport default function RectangularButton({ empty = true, variant = 'stone', style }) {\n  const skin = empty\n    ? (\n      variant === 'stone'\n        ? base_skin_stone\n        : base_skin_graphite\n      )\n    : (\n      variant === 'stone'\n        ? skin_foreground_stone\n        : skin_foreground_graphite\n      )\n  return (\n    <View style={[styles.button, style]}>\n      <Image source={skin} style={styles.image} />\n    </View>\n  )\n}\n\nconst styles = StyleSheet.create({\n  button: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    width: '100%',\n    height: '100%',\n    maxWidth: 476/2,\n    maxHeight: 504/2,\n    // borderWidth: 1,\n    // borderColor: 'blue',\n  },\n  baseImage: {},\n  image: {\n    zIndex: -1,\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    // borderWidth: 1,\n    // borderColor: 'red',\n    resizeMode: 'contain',\n    justifyContent: 'center',\n  }\n});\n","import React from 'react'\nimport { StyleSheet } from 'react-native'\nimport { View } from 'react-native'\nimport Star from './star'\n\nconst Stars = ({ variant = \"stone\", value = 2, style = {} }) => {\n  return  (\n    <View style={[{\n      flex: 1,\n      flexDirection: 'row',\n      // borderWidth: 1,\n    }, style]}>\n      <Star variant={variant} empty={value < 1} style={[styles.smallStar, styles.leftStar]} />\n      <Star variant={variant} empty={value < 2} />\n      <Star variant={variant} empty={value < 3} style={[styles.smallStar, styles.rightStar]} />\n    </View>\n\n  )\n}\n\nexport default Stars\n\nconst styles = StyleSheet.create({\n  smallStar: {\n    // width: 476/2 * 0.9,\n    // height: 504/2 * 0.9,\n    marginTop: 10,\n  },\n  leftStar: {\n    transform: [{rotate: '-10deg'}, { scale: 0.9 }],\n  },\n  rightStar: {\n    transform: [{rotate: '10deg'}, { scale: 0.9 }],\n  }\n})\n","import React from 'react'\nimport Stars from '../../screenComponents/Stars'\n\nexport default () => (\n  <>\n    <Stars style={{ width: 300, height: 100}}/>\n  </>\n)","import React, { useRef, forwardRef, useState, useEffect } from 'react'\nimport { useLoader } from 'react-three-fiber'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport { EffectComposer, Outline, Bloom, SelectiveBloom } from '@react-three/postprocessing'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/trophy/individual_trophy.obj'\nimport modelMtl from '../../../assets/trophy/individual_trophy.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\n// const assetURL = 'https://raw.githubusercontent.com/Cosmitar/threejs_assets/master/ufo_ships/enemy_ufoPurple.glb'\n\nconst getGradientMap = color => {\n  const alphaIndex = 1\n  const colors = new Uint8Array( alphaIndex + 2 )\n\n  for ( let c = 0; c <= colors.length; c ++ ) {\n\n    colors[ c ] = ( c / colors.length ) * 256;\n\n  }\n\n  const gradientMap = new THREE.DataTexture( colors, colors.length, 1, THREE.LuminanceFormat );\n  gradientMap.minFilter = THREE.NearestFilter;\n  gradientMap.magFilter = THREE.NearestFilter;\n  gradientMap.generateMipmaps = false;\n  return gradientMap\n}\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const matTest = new THREE.MeshBasicMaterial({ color: 'lime' })\n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialCore = colorPalette[2] ? new THREE.MeshToonMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n\n  const loadObject = () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return !geometry ? null : (\n    <EffectComposer>\n      <Outline selection={[\n        { current: geometry.children[1] }\n      ]} visibleEdgeColor=\"golden\" edgeStrength={1} pulseSpeed={0} blur={true} />\n      <group\n        ref={fwdRef}\n        scale={[8,8,8]}\n        {...moreProps}\n      >\n        {geometry &&\n          <primitive object={geometry} />\n        }\n      </group>\n    </EffectComposer>\n  )\n})","import React, { useRef, forwardRef, useState, useEffect } from 'react'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\nconst getGradientMap = color => {\n  const alphaIndex = 1\n  const colors = new Uint8Array( alphaIndex + 2 )\n\n  for ( let c = 0; c <= colors.length; c ++ ) {\n\n    colors[ c ] = ( c / colors.length ) * 256;\n\n  }\n\n  const gradientMap = new THREE.DataTexture( colors, colors.length, 1, THREE.LuminanceFormat );\n  gradientMap.minFilter = THREE.NearestFilter;\n  gradientMap.magFilter = THREE.NearestFilter;\n  gradientMap.generateMipmaps = false;\n  return gradientMap\n}\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef(({ modelObj, modelMtl, ...props }, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  // const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  // const matTest = new THREE.MeshBasicMaterial({ color: 'lime' })\n  // const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  // const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  // const materialCore = colorPalette[2] ? new THREE.MeshToonMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  // const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n\n  const loadObject = () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    // console.log(obj.children[0].material)\n    obj.children[0].material = new THREE.MeshLambertMaterial({ color: '#444444' })\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return !geometry ? null : (\n    <group\n      ref={fwdRef}\n      {...props}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n    </group>\n  )\n})","import React from 'react'\nimport BasicObj from '../BasicObj'\nimport modelObj from '../../../assets/rocks/detail_rocks.obj'\nimport modelMtl from '../../../assets/rocks/detail_rocks.mtl'\n\nexport default (props) => (\n  <BasicObj\n    modelObj={modelObj}\n    modelMtl={modelMtl}\n    {...props}\n  />\n)\n","import React, { useRef, forwardRef, useState, useEffect } from 'react'\nimport { THREE } from 'expo-three'\nimport { EffectComposer, Outline, Bloom, SelectiveBloom } from '@react-three/postprocessing'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/crystals/detail_crystalLarge.obj'\nimport modelMtl from '../../../assets/crystals/detail_crystalLarge.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\nconst getGradientMap = color => {\n  const alphaIndex = 1\n  const colors = new Uint8Array( alphaIndex + 2 )\n\n  for ( let c = 0; c <= colors.length; c ++ ) {\n\n    colors[ c ] = ( c / colors.length ) * 256;\n\n  }\n\n  const gradientMap = new THREE.DataTexture( colors, colors.length, 1, THREE.LuminanceFormat );\n  gradientMap.minFilter = THREE.NearestFilter;\n  gradientMap.magFilter = THREE.NearestFilter;\n  gradientMap.generateMipmaps = false;\n  return gradientMap\n}\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  // const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  // const matTest = new THREE.MeshBasicMaterial({ color: 'lime' })\n  // const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  // const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  // const materialCore = colorPalette[2] ? new THREE.MeshToonMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  // const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n\n  const loadObject = () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    console.log(obj.children)\n    obj.children[0].material = new THREE.MeshLambertMaterial({ color: 0x006600 })\n    obj.children[1].material = new THREE.MeshLambertMaterial({ color: 0x2a4db5 })\n    obj.children[2].material = new THREE.MeshLambertMaterial({ color: 0x99ccff })\n    obj.children[3].material = new THREE.MeshLambertMaterial({ color: 0x444444 })\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return !geometry ? null : (\n    // <EffectComposer>\n    //   <Outline selection={[\n    //     { current: geometry.children[0] }\n    //   ]} visibleEdgeColor={0x006600} edgeStrength={1} pulseSpeed={0.5} blur={true} />\n    //   <Outline selection={[\n    //     { current: geometry.children[1] }\n    //   ]} visibleEdgeColor={0x2a4db5} edgeStrength={1} pulseSpeed={0.5} blur={true} />\n    //   <Outline selection={[\n    //     { current: geometry.children[2] }\n    //   ]} visibleEdgeColor={0x99ccff} edgeStrength={1} pulseSpeed={0.5} blur={true} />\n    // </EffectComposer>\n      <group\n        \n        {...props}\n      >\n          {/* <Bloom luminanceThreshold={0.01} luminanceSmoothing={1} height={100} /> */}\n        {geometry &&\n          <primitive object={geometry} ref={fwdRef} />\n        }\n      </group>\n  )\n})","import React, { useRef, useState, useEffect } from 'react'\nimport { Canvas, useThree, useFrame } from 'react-three-fiber'\nimport { OrbitControls, Sky, Shadow, PerspectiveCamera, useHelper, gridHelper, Stars, axesHelper } from 'drei'\nimport Trophy from '../../components/Trophy'\nimport Rock from '../../components/RockCube'\nimport UfoModel1 from '../../components/UfoModels/UfoModel1'\nimport UfoModel2 from '../../components/UfoModels/UfoModel2'\nimport UfoModel3 from '../../components/UfoModels/UfoModel3'\nimport UfoModel4 from '../../components/UfoModels/UfoModel4'\nimport UfoShip from '../../components/UfoShip'\nimport Rocks from '../../components/Rocks'\nimport CrystalRock from '../../components/CrystalRock'\nimport { PALETTES } from '../../constants/gameOptions'\nimport { Physics } from '../../systems/Physics'\nimport { WorldEvents } from '../../systems/World'\nimport { useEvents } from '../../systems/World/hooks'\nimport { CHARACTER_EVENTS } from '../../systems/World/Events'\nimport { THE_END_BEGINS, THE_END_ENDS } from '../../constants/webView_comm_messages';\n\nconst CameraHelper = ({ pivot }) => {\n  const rotationSpeed = useRef()\n  const elevationFactor = useRef(0.002)\n  const animeTimeline = useRef()\n  \n  useFrame(() => {\n    if (pivot.current) {\n      if (rotationSpeed.current) {\n        if (pivot.current.children[0].position.z > 2) {\n          pivot.current.children[0].position.z -= 0.002\n        }\n\n        // if still going up\n        if (elevationFactor.current > 0) {\n          // normal rotation\n          pivot.current.rotation.y += rotationSpeed.current\n        } else {\n          if (elevationFactor.current < 0) {\n            rotationSpeed.current -= 0.0000105\n            if (rotationSpeed.current > 0) {\n              pivot.current.rotation.y += rotationSpeed.current\n            } else {\n              window.ReactNativeWebView?.postMessage(THE_END_ENDS)\n            }\n          }\n        }\n          \n        if (pivot.current.children[0].position.y < 2.5) {\n          pivot.current.children[0].position.y += elevationFactor.current\n        } else {\n          // slow down elevation\n          elevationFactor.current -= 0.00001\n          // while positive (or it will go dow)\n          if (elevationFactor.current > 0) {\n            pivot.current.children[0].position.y += elevationFactor.current\n          }\n          // console.log(pivot.current.rotation.y)\n        }\n      } else {\n        rotationSpeed.current = 0.0075\n        // setStartAnimation(true)\n      }\n\n      pivot.current.children[0].lookAt(0, pivot.current.children[0].position.y, 0)\n    }\n  })\n  return null\n}\nexport default () => {\n  const frozenUfoRef = useRef()\n  const freezeEventTrigger = useEvents(CHARACTER_EVENTS.GETS_FREEZER)\n  // const { camera } = useThree()\n  const cameraPivot = useRef()\n  \n  \n  return (\n    <WorldEvents>\n      <Canvas\n          style={{ background: \"#171717\" }}\n          shadowMap\n          // pixelRatio={Dimensions.get('window').height / Dimensions.get('window').width}\n          camera={{ position: [-1.5, 0, 4], fov: 30 }}\n          concurrent\n          gl={{ antialias: true }}\n          onCreated={({ gl, camera, scene }) => {\n            cameraPivot.current = new THREE.Object3D();\n            cameraPivot.current.add(camera)\n            scene.add( cameraPivot.current );\n\n            // scene.fog = new THREE.Fog('black', 4, 11);\n\n            setTimeout(() => {\n              freezeEventTrigger(frozenUfoRef.current.uuid)\n              window.ReactNativeWebView?.postMessage(THE_END_BEGINS)\n            }, 3000);\n          }}\n        >\n          <CameraHelper pivot={cameraPivot}/>\n          <ambientLight intensity={0.5} color=\"0x888888\" />\n          {/* <pointLight color=\"0xffffff\" intensity={0.5} distance={800} position={[0, 2, 4]} />\n          <pointLight color=\"0xffffff\" intensity={0.5} distance={800} position={[-4, -4, 1]} /> */}\n          <directionalLight\n              castShadow\n              position={[5, 8, -5]}\n              intensity={0.1}\n              // color=\"#ff9760\"\n              color=\"#ffffff\"\n              shadow-mapSize-width={600}\n              shadow-mapSize-height={600}\n              shadow-camera-far={50}\n              shadow-camera-left={-10}\n              shadow-camera-right={10}\n              shadow-camera-top={10}\n              shadow-camera-bottom={-10}\n              />\n          <directionalLight\n              castShadow\n              position={[-5, 8, 5]}\n              intensity={0.1}\n              // color=\"#ff9760\"\n              color=\"#ffffff\"\n              shadow-mapSize-width={600}\n              shadow-mapSize-height={600}\n              shadow-camera-far={50}\n              shadow-camera-left={-10}\n              shadow-camera-right={10}\n              shadow-camera-top={10}\n              shadow-camera-bottom={-10}\n              />\n          <Trophy\n            position={[0.1, 2.6, -0.4]}\n          />\n          <UfoModel1\n            position={[-0.25, 2.7, -0.55]}\n            scale={[0.5, 0.5, 0.5]}\n            colorPalette={PALETTES[1]}\n          />\n          <UfoModel4\n            position={[-0.45, 0.45, 0.85]}\n            scale={[0.45, 0.45, 0.45]}\n            colorPalette={PALETTES[4]}\n          />\n            <group\n              position={[0.45, 0.65, -1]}\n              rotation={[0, Math.PI/4, 0]}\n              >\n              <UfoModel3\n                scale={[0.45, 0.45, 0.45]}\n                enemies={[]}\n                colorPalette={PALETTES[3]}\n                rotation={[Math.PI/1.5, 0, 0]}\n                />\n            </group>\n          <UfoModel2\n            position={[0, 1.4, 0]}\n            scale={[0.45, 0.45, 0.45]}\n            colorPalette={PALETTES[2]}\n          />\n          <Physics>\n            <group\n              position={[-0.45, 1.45, -0.85]}\n              rotation={[-Math.PI/8, 0, 0]}\n            >\n              <UfoShip\n                ref={frozenUfoRef}\n                model={4}\n                rotation={[0, 0, Math.PI/8]}\n                scale={[0.45, 0.45, 0.45]}\n                // colorPalette={PALETTES[4]}\n                userData={{\n                  detached: true\n                }}\n              />\n            </group>\n          </Physics>\n          {/* BASE */}\n          <Rock\n            texture={require('../../../assets/textures/cube_rock_A_mat_baseColor.png')}\n            scale={[1.5, 1, 2.4]}\n            receiveShadow\n          />\n          {/* MID ROCK */}\n          <Rock\n            texture={require('../../../assets/textures/cube_rock_A_mat_baseColor.png')}\n            scale={[1, 1, 1]}\n            position={[-0.2, 0.9, -0.5]}\n            rotation={[0, Math.PI / 2, 0]}\n            receiveShadow\n          />\n          {/* THINK ROCK */}\n          <Rock\n            texture={require('../../../assets/textures/cube_rock_A_mat_baseColor.png')}\n            scale={[0.3, 1, 1]}\n            position={[0, 0.9, 0.2]}\n            rotation={[0, Math.PI * 1.5, Math.PI / 8]}\n            receiveShadow\n          />\n          {/* SMALL ROCK */}\n          <Rock\n            texture={require('../../../assets/textures/cube_rock_A_mat_baseColor.png')}\n            scale={[0.5, 0.5, 0.5]}\n            position={[0, 0.5, 0.5]}\n            rotation={[0, Math.PI / 2, 0]}\n            receiveShadow\n          />\n          {/* STEP ROCK */}\n          <Rock\n            texture={require('../../../assets/textures/cube_rock_A_mat_baseColor.png')}\n            scale={[0.5, 0.2, 0.7]}\n            position={[-0.8, 0.9, -0.5]}\n            // rotation={[0, Math.PI / 2, 0]}\n            receiveShadow\n          />\n          {/* TOWER ROCK */}\n          <Rock\n            texture={require('../../../assets/textures/cube_rock_A_mat_baseColor.png')}\n            scale={[0.6, 2.5, 0.6]}\n            position={[0, 1.5, -0.5]}\n            // rotation={[0, Math.PI / 2, 0]}\n            receiveShadow\n          />\n          <Rocks\n            scale={[0.5, 0.5, 0.5]}\n            position={[0.45, 0.48, 0.85]}\n          />\n          <CrystalRock\n            scale={[0.5, 0.5, 0.5]}\n            position={[-0.8, 0.99, -0.55]}\n          />\n          {/* <WCTrophy /> */}\n          {/* <OrbitControls /> */}\n          {/* <gridHelper /> */}\n          <Sky\n            sunPosition={[0, 0, -4]}\n            distance={3000}\n            turbidity={8}\n            rayleigh={6}\n            mieCoefficient={0.005}\n            mieDirectionalG={0.8}\n            inclination={0.69}\n            azimuth={0.25}\n          />\n      </Canvas>\n    </WorldEvents>\n  )\n}","import React, { useEffect, useRef, useState } from 'react'\nimport GameScene from './GameScene'\nimport TitleScene from './TitleScene'\nimport DebugScene from './DebugScene'\nimport TheEndScene from './TheEndScene'\nimport {\n  ON_LINE_NOTIFICATION,\n  SCENE_LOADED,\n} from '../constants/webView_comm_messages'\n\nconst sceneSelector = sceneName => {\n  switch (sceneName) {\n    case 'TitleScene':\n      return TitleScene\n    case 'GamePlayScene':\n      return GameScene\n    case 'DebugScene':\n      return DebugScene\n    case 'TheEndScene':\n      return TheEndScene\n    default:\n  }\n}\n\nexport default function scenes() {\n  const [sceneName, setScene] = useState(window.SS_initial_scene)\n  const sceneParams = useRef({})\n  const SceneToRender = sceneSelector(sceneName)\n  const notifyOnLoad = useRef(() => {\n    console.log('NOTIFY ALL LOADED')\n    // notify scene loaded\n    window.ReactNativeWebView?.postMessage(SCENE_LOADED)\n  }).current\n  \n  useEffect(() => {\n    // methods to change scenes from global scope\n    window.SS_change_scene = (sceneName, params = {}) => {\n      sceneParams.current = params\n      setScene(sceneName)\n    }\n    // notify system on-line\n    window.ReactNativeWebView?.postMessage(ON_LINE_NOTIFICATION)\n  }, [])\n\n  return SceneToRender ? <SceneToRender onLoad={notifyOnLoad} {...sceneParams.current}/> : null\n}\n","import { StatusBar } from 'expo-status-bar';\nimport React, { useEffect } from 'react';\nimport { StyleSheet, Text, View } from 'react-native'\nimport SceneManager from './src/scenes'\n\nexport default function App() {\n  useEffect(() => {\n    const document = window.document\n    // Global site tag (gtag.js) - Google Analytics\n    const script = document.createElement('script')\n    script.async = true\n    script.src = 'https://www.googletagmanager.com/gtag/js?id=G-P453ENWNTN'\n    document.head.appendChild(script)\n\n    window.dataLayer = window.dataLayer || [];\n    function gtag() { window.dataLayer.push(arguments);}\n    gtag('js', new Date());\n    gtag('config', 'G-P453ENWNTN');\n    \n  }, [])\n  return (\n    <>\n      <SceneManager />\n      {/* <Titles /> */}\n      {/* <Stats /> */}\n      {/* <Canvas\n        style={{ background: \"#171717\" }}\n        // shadowMap\n        // pixelRatio={Dimensions.get('window').height / Dimensions.get('window').width}\n        camera={{ position: [-5, 10, 20], fov: 30 }}\n        concurrent\n        gl={{ antialias: false, alpha: true }}\n        onCreated={({ gl }) => {\n          gl.setClearColor(0xff0000, 1)\n          // gl.toneMapping = THREE.Uncharted2ToneMapping\n          // gl.setClearColor(new THREE.Color('#020207'))\n        }}\n      >\n        <ambientLight intensity={1} color=\"gray\" />\n        <pointLight position={[10, 10, 10]} intensity={1} color=\"white\" />\n        <Test position={[1.2, 0, -5]}/>\n        <OrbitControls />\n      </Canvas> */}\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n});\n","import { registerRootComponent } from 'expo';\n\nimport App from './App';\n\n// registerRootComponent calls AppRegistry.registerComponent('main', () => App);\n// It also ensures that whether you load the app in the Expo client or in a native build,\n// the environment is set up appropriately\nregisterRootComponent(App);\n","module.exports = __webpack_public_path__ + \"static/media/threeTone.f981ce1c.jpg\";","import React, { Suspense, createContext, lazy } from 'react'\nimport { EventsManager } from './EventsManager'\n\nconst context = createContext(EventsManager)\nconst Provider = typeof window === 'undefined' ? () => null : lazy(() => import('./EventsProvider'))\n\nfunction WorldEvents(props) {\n  return (\n    <Suspense fallback={null}>\n      <Provider {...props} />\n    </Suspense>\n  )\n}\n\nexport { WorldEvents, context }\n","export const CHARACTER_EVENTS = {\n  // the character is out of arena\n  OUT_OF_RING: 'out_of_ring',\n  BEGIN_CONTACT: 'on_begin_contact',\n  END_CONTACT: 'on_end_contact',\n  OVERCHARGE: 'on_overcharge',\n  DISCHARGE: 'on_discharge',\n  GETS_FREEZER: 'on_get_freezer_hit',\n  GETS_COIL: 'on_get_coil_hit',\n  PICK_CRYSTAL_FREEZER: 'on_pick_crystal_freezer',\n  PICK_CRYSTAL_HULK: 'on_pick_crystal_hulk',\n  PICK_CRYSTAL_COIL: 'on_pick_crystal_coil',\n  EXTERNAL_SPIN_CHANGE: 'on_external_force_change_spin',\n  TELEPORT: 'on_teleport_use',\n  IMPULSE_ON: 'on_impulse_itself',\n  IMPULSE_OFF: 'on_stop_impulse_itself'\n}\n\nexport const GAME_EVENTS = {\n  READY_ON: 'gameplay_ready_on',\n  READY_OFF: 'gameplay_ready_off',\n  SYSTEM_ONLINE: 'gameplay_system_is_online',\n}","/** eventsService */\nclass EventsService {\n  constructor() {\n    this.callbacks = {}\n  }\n\n  /**\n   * @param {string} eventName\n   * @param {*} data\n   */\n  dispatch(eventName, data = null) {\n    if (this.callbacks[eventName]) {\n      this.callbacks[eventName].forEach(callback => {\n        callback(data);\n      });\n    }\n  }\n\n  /**\n   * @param {string} eventName name of event\n   * @param {Function} callback\n   */\n  addEventListener(eventName, callback) {\n    if (!this.callbacks.hasOwnProperty(eventName)) {\n      this.callbacks[eventName] = [];\n    }\n    this.callbacks[eventName].push(callback);\n    \n    // return unsubscribe\n    return () => this.removeEventListener(eventName, callback)\n  }\n\n  /**\n   * @param {string} eventName name of event\n   * @param {Function} callback\n   */\n  removeEventListener(eventName, callback) {\n    this.callbacks[eventName] = this.callbacks[eventName].filter(cb => cb !== callback)\n  }\n}\n\nexport default EventsService"],"sourceRoot":""}